function ::dcCreateTable()
{
  object c2Obj = dom.GetObject( system.GetVar("cId") );
  string sName = c2Obj.Name();

  WriteLine('<table cellpadding="0" cellspacing="0" class="CLASS02500">');

  if( iFavNamePosition == 1 )
  {
    WriteLine('<tr>');
      WriteLine('<td class="CLASS02501">');
      WriteLine('<div class="CLASS02502">' # sName # '</div>');
      WriteLine('<td>');
    WriteLine('</tr>');
  
    WriteLine('<tr>');
      WriteLine('<td class="CLASS02503"><div class="CLASS02504" style="visibility:hidden;"></div></td>');
    WriteLine('</tr>');
  
    WriteLine('<tr>');
      WriteLine('<td id="dpc'#cId#'" class="CLASS02505">');
        Call("/esp/datapointconfigurator.fn::dcCreate()");
      WriteLine('</td>');
    WriteLine('</tr>');
  
    WriteLine('<tr>');
      WriteLine('<td class="CLASS02503"><div class="CLASS02504" style="visibility:hidden;"></div></td>');
    WriteLine('</tr>');
  }
  
  if( iFavNamePosition == 0 )
  {
    integer iLength = 9;
    Call("/esp/datapointconfigurator.fn::StringCut()");
  
    WriteLine('<tr>');
      WriteLine('<td class="CLASS02506"></td>');
      WriteLine('<td class="CLASS02506"></td>');
    WriteLine('</tr>');
  
    WriteLine('<tr>');
      WriteLine('<td class="CLASS02507">');
      WriteLine('<div class="CLASS02509">'#sName#'</div></td>');
      WriteLine('<td id="dpc'#cId#'" class="CLASS02508">');
        Call("/esp/datapointconfigurator.fn::dcCreate()");
      WriteLine('</td>');
    WriteLine('</tr>');
  
    WriteLine('<tr>');
      WriteLine('<td class="CLASS02506"></td>');
      WriteLine('<td class="CLASS02506"></td>');
    WriteLine('</tr>');
  }
  WriteLine('</table>');
}

! dcCreate()
! [cId]: idnumber, [iStatusOnly]: Controls (un)bedienbar
function ::dcCreate()
{
  ! Control Button Dimensions
  integer ictCH = 0;
  integer chnId = system.GetVar("cId");
  boolean ctrlReqUpdate = false;
  object cObj = dom.GetObject( system.GetVar("cId") );
  
  if( cObj.IsTypeOf( OT_PROGRAM ) )
  {
    ictCH = 0;
    ctrlReqUpdate = true;
    string progId = cObj.ID();
    string viewstatus = "";
    Call("/esp/system.fn::writeProgCtrl()");
  }
  
  if( cObj.IsTypeOf( OT_DP ) )
  {
    ictCH = 0;
    ctrlReqUpdate = true;
    integer iVT = cObj.ValueType();
    integer iST = cObj.ValueSubType();
    boolean bLogic  = ( (iVT==ivtBinary)  && (iST==istBool)    );
    boolean bList   = ( (iVT==ivtInteger) && (iST==istEnum)    );
    boolean bNumber = ( (iVT==ivtFloat)   && (iST==istGeneric) );
    boolean bAlarm  = ( (iVT==ivtBinary)  && (iST==istAlarm)   );
    boolean bString = ( (iVT==ivtString)  && (iST==istChar8859));
    boolean bSysVar = ( bLogic || bList || bNumber || bAlarm || bString);
    if( bSysVar )
    {
      WriteLine( '<table id="ctrl'#chnId#'tbl" cellspacing="0" class="ctrlTbl CLASS02510" border="0">' );
      WriteLine( '<tr align="center">' );
      Call( "/esp/datapointconfigurator.fn::CreateSysVar()" );
      WriteLine( '</tr>' );
      WriteLine( '</table>' );
    }
  }
    
  if( cObj.IsTypeOf( OT_CHANNEL ) )
  {
    var CN_NONE            = "NONE";
    var CN_SWITCH          = "SWITCH.";
    var CN_DIMMER          = "DIMMER.";
    var CN_BLIND           = "BLIND.";
    var CN_WINDOW          = "WINDOW.";
    var CN_LOCK            = "LOCK.";
    var CN_BUTTON          = "BUTTON.";
		var CN_BTN_SHORT_ONLY	 = "BTN_SHORT_ONLY.";
    var CN_DOOR_OPENER     = "DOOROPENER.";
    var CN_RC19_DISPLAY    = "RC19_DISPLAY.";
    var CN_DOOR_SENSOR     = "DOOR_SENSOR.";
    var CN_RHS             = "RHS.";
    var CN_THERMO          = "TEMP.";
    var CN_DIGITAL_ANALOG_OUTPUT            = "DIGITAL_ANALOG_OUTPUT.";
    var CN_CAPACITIVE_FILLING_SENSOR  = "CAPACITIVE_FILLING_LEVEL_SENSOR.";
    var CN_DANGER          = "DANGER.";
    var CN_WIN_SC          = "WIN_SC.";
    var CN_WIN_SC_SENSOR          = "WIN_SC_SENSOR.";
    var CN_WIN_SC_SECURE          = "WIN_SC_SECURE.";
    var CN_HEATING_CONTROL          = "HEATING_CONTROL.";
    var CN_POWERMETER          = "POWERMETER.";
    var CN_POWERMETER_IGL          = "POWERMETER_IGL.";

    var CN_EVENT_INTERFACE = "EVENT_INTERFACE.";
    var CN_NOT_ACTIVE = "CHANNEL_NOT_ACTIVE";

    var isInvisible = false;
    var isKnownControl = false;
    
    ctrlReqUpdate = true;
    boolean bUnknown = true;
    string sLastControlName = "";
    string sControlName = "";
    boolean bSV = false;
    boolean bIsControl = false;
    
    ictCH = cObj.ChannelType();
    WriteLine("<table id='ctrl"#chnId#"tbl' class='ctrlTbl CLASS02520' border='0' >");
    WriteLine("<tr>");
    
    string sE;
    foreach( sE, cObj.DPs().EnumEnabledVisibleIDs() )
    {
      object oE = dom.GetObject( sE );
      if( oE )
      {
        sControlName = oE.MetaData("CONTROL");
        if( sControlName )
        {
          !# NONE
          bIsControl = ( sControlName.Find(CN_NONE) > -1 );
          if( bIsControl && (sLastControlName != CN_NONE) )
          {
            ! IGNORE NONE
          }
        
          !# SWITCH
          bIsControl = ( sControlName.Find(CN_SWITCH) > -1 );
          if( bIsControl && (sLastControlName != CN_SWITCH) )
          {
            WriteLine( "<script>conInfo('Control SWITCH found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_SWITCH;
            Call("/esp/datapointconfigurator.fn::CreateBinaryActuator()");
          }
          
          !# DIMMER
          bIsControl = ( sControlName.Find(CN_DIMMER) > -1 );
          if( bIsControl && (sLastControlName!=CN_DIMMER) )
          {
            WriteLine( "<script>conInfo('Control DIMMER found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_DIMMER;
            Call("/esp/datapointconfigurator.fn::CreateDimmingActuator()");
          }

          !# BLIND
          bIsControl = ( sControlName.Find(CN_BLIND) > -1 );
          if( bIsControl && (sLastControlName!=CN_BLIND) )
          {
            WriteLine( "<script>conInfo('Control BLIND found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_BLIND;
            Call("/esp/datapointconfigurator.fn::CreateShutterActuator()");
          }

          !# WINDOW
          bIsControl = ( sControlName.Find(CN_WINDOW) > -1 );
          if( bIsControl && (sLastControlName!=CN_WINDOW) )
          {
            WriteLine( "<script>conInfo('Control WINDOW found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_WINDOW;
            Call("/esp/datapointconfigurator.fn::CreateWinMatic()");
          }
          
          !# LOCK
          bIsControl = ( sControlName.Find(CN_LOCK) > -1 );
          if( bIsControl && (sLastControlName!=CN_LOCK) )
          {
            WriteLine( "<script>conInfo('Control LOCK found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_LOCK;
            Call("/esp/datapointconfigurator.fn::CreateKeyMatic()");
          }
 
					!# BTN
          bIsControl = ( sControlName.Find(CN_BTN_SHORT_ONLY) > -1 ); !### Attention: workaround
          if( bIsControl && (sLastControlName!=CN_BTN_SHORT_ONLY) )
          {
            WriteLine( "<script>conInfo('Control BTN_SHORT_ONLY found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_BTN_SHORT_ONLY;
            Call("/esp/datapointconfigurator.fn::CreateKeyShortOnly()");
          }
         
          !# BUTTON
          bIsControl = ( sControlName.Find(CN_BUTTON) > -1 ); !### Attention: workaround
          if( bIsControl && (sLastControlName!=CN_BUTTON) )
          {
            WriteLine( "<script>conInfo('Control BUTTON found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_BUTTON;
            Call("/esp/datapointconfigurator.fn::CreateKey()");
          }
         
          !# DOOROPENER
          bIsControl = ( sControlName.Find(CN_DOOR_OPENER) > -1 ); !### Attention: workaround
          if( bIsControl && (sLastControlName!=CN_DOOR_OPENER) )
          {
            WriteLine( "<script>conInfo('Control DOOROPENER found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_DOOR_OPENER;
            Call("/esp/datapointconfigurator.fn::CreateDoorOpener()");
          }

          !# RC19_DISPLAY
          bIsControl = ( sControlName.Find(CN_RC19_DISPLAY) > -1 );
          if( bIsControl && (sLastControlName!=CN_RC19_DISPLAY) )
          {
            WriteLine( "<script>conInfo('Control RC19_DISPLAY found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_RC19_DISPLAY;
            Call("/esp/datapointconfigurator.fn::CreateDisplay()");
          }

          !# DOOR_WINDOW_CONTACT
          bIsControl = ( sControlName.Find(CN_DOOR_SENSOR) > -1 );
          if( bIsControl && (sLastControlName!=CN_DOOR_SENSOR) )
          {
            WriteLine( "<script>conInfo('Control DOOR_WINDOW_CONTACT found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_DOOR_SENSOR;
            Call("/esp/datapointconfigurator.fn::CreateDoorWindowContact()");
          }
          
          !# RHS (Rotary Handle Sensor - Fensterdrehgriffkontakt)
          bIsControl = ( sControlName.Find(CN_RHS) > -1 );
          if( bIsControl && (sLastControlName!=CN_RHS) )
          {
            WriteLine( "<script>conInfo('Control RHS found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_RHS;
            Call("/esp/datapointconfigurator.fn::CreateWndRotSensor()");
          }
          
          !# THERMOSTAT
          bIsControl = ( sControlName.Find(CN_THERMO) > -1 );
          if( bIsControl && (sLastControlName!=CN_THERMO) )
          {
            WriteLine( "<script>conInfo('Control THERMOSTAT found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_THERMO;
            Call("/esp/datapointconfigurator.fn::CreateThermostat()");
          }

          !# FREQUENCY
          bIsControl = ( sControlName.Find(CN_DIGITAL_ANALOG_OUTPUT) > -1 );
          if( bIsControl && (sLastControlName!=CN_DIGITAL_ANALOG_OUTPUT) )
          {
            WriteLine( "<script>conInfo('Control DIGITAL_ANALOG_OUTPUT found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_DIGITAL_ANALOG_OUTPUT;
            Call("/esp/datapointconfigurator.fn::CreateFrequency()");
          }

          !# CAPACITIVE FILLING LEVEL SENSOR 
          bIsControl = ( sControlName.Find(CN_CAPACITIVE_FILLING_SENSOR) > -1 );
          if( bIsControl && (sLastControlName!=CN_CAPACITIVE_FILLING_SENSOR) )
          {
            WriteLine( "<script>conInfo('Control  CAPACITIVE_FILLING_SENSOR found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_CAPACITIVE_FILLING_SENSOR;
            Call("/esp/datapointconfigurator.fn::CreateCapacitiveFillingSensor()");
          }


         !# DANGER
          bIsControl = ( sControlName.Find(CN_DANGER) > -1 );     !#### Attention: workaround!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
          if( bIsControl && (sLastControlName!=CN_DANGER) )
          {
            WriteLine( "<script>conInfo('Control DANGER-Sensor found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_DANGER;
            Call("/esp/datapointconfigurator.fn::CreateDangerSensor()");
          }

          !# WIN_SC
          bIsControl = ( sControlName.Find(CN_WIN_SC) > -1 );
          if( bIsControl && (sLastControlName!=CN_WIN_SC) )
          {
            !WriteLine( "<script>conInfo('Control WIN_SC found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_WIN_SC;
            Call("/esp/datapointconfigurator.fn::CreateWin_SC()");
          }

          !# WIN_SC_SENSOR
          bIsControl = ( sControlName.Find(CN_WIN_SC_SENSOR) > -1 );
          if( bIsControl && (sLastControlName!=CN_WIN_SC_SENSOR) )
          {
            !WriteLine( "<script>conInfo('Control WIN_SC_SENSOR found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_WIN_SC_SENSOR;
            Call("/esp/datapointconfigurator.fn::CreateWin_SC_SENSOR()");
          }

          !# WIN_SC_SECURE
          bIsControl = ( sControlName.Find(CN_WIN_SC_SECURE) > -1 );
          if( bIsControl && (sLastControlName != CN_WIN_SC_SECURE) )
          {
            !WriteLine( "<script>conInfo('Control CN_WIN_SC_SECURE found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_WIN_SC_SECURE;
            Call("/esp/datapointconfigurator.fn::CreateWin_SC_SECURE()");
          }

          !# HEATING_CONTROL
          bIsControl = ( sControlName.Find(CN_HEATING_CONTROL) > -1 );
          if( bIsControl && (sLastControlName != CN_HEATING_CONTROL) )
          {
            WriteLine( "<script>conInfo('Control CN_HEATING_CONTROL found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_HEATING_CONTROL;
            Call("/esp/datapointconfigurator.fn::CreateHeatingControl()");
          }

          !# POWERMETER
          bIsControl = ( sControlName.Find(CN_POWERMETER) > -1 );
          if( bIsControl && (sLastControlName != CN_POWERMETER) )
          {
            WriteLine( "<script>conInfo('Control CN_POWERMETER found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_POWERMETER;
            Call("/esp/datapointconfigurator.fn::CreatePowermeterControl()");
          }

          !# POWERMETER_IGL
          bIsControl = ( sControlName.Find(CN_POWERMETER_IGL) > -1 );
          if( bIsControl && (sLastControlName != CN_POWERMETER_IGL) )
          {
            WriteLine( "<script>conInfo('Control CN_POWERMETER_IGL found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_POWERMETER_IGL;
            Call("/esp/datapointconfigurator.fn::CreatePowermeterIGLControl()");
          }

          !# EVENT_INTERFACE
          bIsControl = ( sControlName.Find(CN_EVENT_INTERFACE) > -1 );
          if( bIsControl && (sLastControlName!=CN_EVENT_INTERFACE) )
          {
            WriteLine( "<script>conInfo('Control EVENT_INTERFACE found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_EVENT_INTERFACE;
            Call("/esp/datapointconfigurator.fn::CreateEventInterface()");
          }

          !# CHANNEL_NOT_ACTIVE
          bIsControl = ( sControlName.Find(CN_NOT_ACTIVE) > -1 );
          if( bIsControl && (sLastControlName!=CN_NOT_ACTIVE) )
          {
            WriteLine( "<script>conInfo('Control CHANNEL_NOT_ACTIVE found.');</script>" );
            isKnownControl = true;
            sLastControlName = CN_NOT_ACTIVE;
            Call("/esp/datapointconfigurator.fn::CreateChannelNotActive()");
          }

        }
        else
        {
          bSV = true;
        }
      }
    }
    if (!isKnownControl)
    {
      WriteLine( "<script>conInfo('Control UNKNOWN found.');</script>" );
      WriteLine( '</tr></table><table cellspacing="0" class="ctrlTbl CLASS02510" border="0" ><tr>' );
      Call("/esp/datapointconfigurator.fn::CreateUnknown()");
    }
    if ( (isKnownControl) && (bSV) )
    {
      WriteLine( "<script>conInfo('SysVar found.');</script>" );
      WriteLine( '</tr></table><table cellspacing="0" class="ctrlTbl CLASS02510" border="0" ><tr>' );
      Call("/esp/datapointconfigurator.fn::CreateSysVars()");
    }
    WriteLine( '</tr>' );
    WriteLine( '</table>' );
  }

  ! write update script
  if( ctrlReqUpdate )
  {
    cId = chnId;
    WriteLine("<script type='text/javascript'>");
    string sLastTime = "";
    Call("/esp/system.fn::getLastTime()");
    if( cObj.IsTypeOf( OT_PROGRAM ) ) {
      WriteLine("updateChannelControl(" # chnId # ", '" # sLastTime # cObj.Active() # "');");
    } else {
      WriteLine("updateChannelControl(" # chnId # ", '" # sLastTime # "');");
    }    WriteLine("</script>");
  }  

    !WriteLine("<script type='text/javascript'>");
      !WriteLine("translatePage('#content')");
    !WriteLine("</script>");

  return;
}

function ::StringCut()
{ 
  if(((sName.Find(" ") == -1) || (sName.Find(" ") >= 9)) && (sName.Length()>9) && (sName.Find("${") == -1))
  {
    string sI = "";
    integer iCurrCut = 0;
    integer iLastCut = 0;
    string sWorkingName = "";

    foreach(sI,system.GenerateEnum(0,sName.Length()))
    {
      iCurrCut = iCurrCut +1;

      if( (iCurrCut % iLength) == 0 )
      {
        sWorkingName = sWorkingName#sName.Substr(iLastCut,iLength)#'<br />';
        iLastCut = iCurrCut;
      }
    }
    sWorkingName = sWorkingName#sName.Substr(iLastCut,sName.Length())#' ';
    sName = sWorkingName;
  }
}

function ::CreateBinaryActuator()
{
  object objState = cObj.DPByControl("SWITCH.STATE");
  if( objState )
  {
    WriteLine("<td class='CLASS02521'>");
      !WriteLine("<div id='"#chnId#"Off' class='ControlBtnOff CLASS02522'>Aus</div>");
      WriteLine("<div id='"#chnId#"Off' class='ControlBtnOff CLASS02522 j_translate'>${actionStatusControlLblOff}</div>");
    WriteLine("</td>");

    WriteLine("<td class='CLASS02521'>");
      !WriteLine("<div id='"#chnId#"On' class='ControlBtnOff CLASS02522'>Ein</div>");
      WriteLine("<div id='"#chnId#"On' class='ControlBtnOff CLASS02522 j_translate'>${actionStatusControlLblOn}</div>");
    WriteLine("</td>");
    WriteLine("<td class='CLASS02523'></td><td class='CLASS02523'></td><td class='CLASS02523'></td>");

    WriteLine("<script type='text/javascript'>");
      WriteLine("ibs"#cObj.ID()#" = new iseButtonsSwitch("#cObj.ID()#", "#objState.Value()#", "#objState.ID()#", " #system.GetVar("iStatusOnly")# ");");

      Write("jQuery('#"#chnId#"Off').html(translateKey('actionStatusControlLblOff')).show();");
      Write("jQuery('#"#chnId#"On').html(translateKey('actionStatusControlLblOn')).show();");

    WriteLine("</script>");
  }
  return;
}

function ::CreateEventInterface()
{
  object objEvent = cObj.DPByControl("EVENT_INTERFACE.TRIGGER");
  if( objEvent )
  {
    WriteLine("<td>");
      WriteLine("<table class='ControlBtnOff CLASS02511' id='"#chnId#"event' >"); 
        WriteLine("<tr>");
          WriteLine("<td  class='CLASS02513'>");
            WriteLine("<div align='center'>");
              WriteLine("<img id='btn"#chnId#"s' src='/ise/img/btn_no_press.png' width='80' height='80' />");
            WriteLine("</div>");            
          WriteLine("</td>");
        WriteLine("</tr>");
        WriteLine("<tr><td id='"#chnId#"Txt'>Betätigen</td></tr>");
      WriteLine("</table>");
    WriteLine("</td>");
    WriteLine("<td class='CLASS02524'>&nbsp;</td>");
    
    WriteLine("<script type='text/javascript'>");
      WriteLine("ibk"#cObj.ID()#" = new iseButtonsEvent("#cObj.ID()#", "#objEvent.ID()#", "#system.GetVar("iStatusOnly")#");");
      Write("jQuery('#"#chnId#"Txt').html(translateKey('actionStatusControlActivate'));");
    WriteLine("</script>");
  }
  return;
}

function ::CreateChannelNotActive()
{
  WriteLine("<td>");
    WriteLine("<table class=\"ControlBtnInfo\">");
      WriteLine("<tr>");
        WriteLine("<td>");
          WriteLine("<div>");
            WriteLine("${controlChannelNotActive}");
          WriteLine("</div>");
        WriteLine("</td>");
      WriteLine("</tr>");
    WriteLine("</table>");
  WriteLine("</td>");
  return;
}


function ::CreateDangerSensor()
{ 
  object objDangerState = cObj.DPByControl("DANGER.STATE");
  boolean bDangerState = objDangerState.Value(); 
  string sFontColorClassName = "CLASS02526";
  string sFontColorDangerClassName = "CLASS02527";
  string sBgColorClassName = "CLASS02525b";
  string sBgColorDangerClassName = "CLASS02557";
  if (bDangerState) {
    sFontColorClassName = "CLASS02527";
    sFontColorDangerClassName = "CLASS02526";
    sBgColorClassName = "CLASS02525";
    sBgColorDangerClassName = "CLASS02558";
  }
  if( objDangerState )
  { 
    WriteLine("<td>");
      WriteLine("<table id='"#chnId#"danger' class='" # sBgColorClassName # "'>"); 
        WriteLine("<tr>");
          WriteLine("<td class='CLASS02518'>");
            WriteLine("<div align='center'>");
              WriteLine("<img id='"#chnId#"checkItem' src='/ise/img/danger/check.png' width='80' height='80' />");
            WriteLine("</div>");
          WriteLine("</td>");
        WriteLine("</tr>");
        WriteLine("<tr><td class='" # sFontColorClassName # "' align='center'>O.K.</td></tr>");
      WriteLine("</table>");         
    WriteLine("</td>");
    WriteLine("<td>");
      WriteLine("<table id='"#chnId#"dangerState' class='" # sBgColorDangerClassName # "'>"); 
        WriteLine("<tr>");
          WriteLine("<td class='CLASS02518'>");
            WriteLine("<div align='center'>");
              WriteLine("<img id='"#chnId#"dangerItem' src='/ise/img/danger/danger.png' width='80' height='80' />");
            WriteLine("</div>");
          WriteLine("</td>");
        WriteLine("</tr>");
        WriteLine("<tr><td align='center' id='"#chnId#"_dangerTxt' class='j_translate " # sFontColorDangerClassName # "'>Gefahr</td></tr>");
      WriteLine("</table>");
    WriteLine("</td>");
    WriteLine("<td class='CLASS02528'>&nbsp;</td>");
  }

  Write("<script type='text/javascript'>");
    Write("jQuery('#"#chnId# "_dangerTxt').html(translateKey('infoStatusControlLblDanger'));");
  Write("</script>");

  return;
}

function ::CreateDimmingActuator()
{
   ! Necessary for checking if the expert mode is active
   object oUser = dom.GetObject( system.GetSessionVar('sessionUserID'));
   integer userID = oUser.ID();
   object user = dom.GetObject(userID);

  integer iLvlDpId = 0;
  integer iOldLvlDpId = 0;
  integer iState = 0;
  real rLevelReal = -1.0;
  string sLevelReal;

  if( cObj.ChannelType() == ictHSSDimmingActuator )
  {
    object oLevel = cObj.DPByControl("DIMMER.LEVEL");
    object oLevelReal = cObj.DPByControl("DIMMER.LEVEL_REAL");
    if( oLevel )
    {
      iLvlDpId = oLevel.ID();
      iState = oLevel.Value() * 100;
    }
    if ( oLevelReal ) {
      rLevelReal = oLevelReal.Value() * 100;
      sLevelReal = rLevelReal.ToString();
    }
    object oOldLevel = cObj.DPByControl("DIMMER.OLD_LEVEL"); 
    if( oOldLevel )
    {
      iOldLvlDpId = oOldLevel.ID();
    }
  }
  WriteLine("<td>");
    WriteLine("<table>");
      WriteLine("<tr>");
        !****************
        WriteLine("<td colspan='3' id='slidCtrl"#cObj.ID()#"' class='CLASS02529'></td>");
        WriteLine("<td class='CLASS02529'>");
          WriteLine("<div class='PercBtn' >");
            WriteLine("<table width='100%' height='100%'>");
              WriteLine("<tr class='CLASS02531'>");
                string sReadOnly = "";
                if( system.GetVar("iStatusOnly") == 1 )
                {
                  sReadOnly = "readonly";
                }
                WriteLine("<td colspan='2' class='CLASS02541'><input id='"#chnId#"Perc' type='text' value='"#iState#"' size='3' class='CLASS02542' "#sReadOnly#" /><b>%</b></td>");
              WriteLine("</tr>");
              WriteLine("<tr>");
                WriteLine("<td align='center' class='CLASS02544'>");
                WriteLine("<table cellspacing='0' cellpadding='0'><tr><td><img id='"#chnId#"Up' height='12px' width='40px' src='/ise/img/up.png' class='CLASS02543'/></td></tr><tr><td><img id='"#chnId#"Down' height='12px' width='40px' src='/ise/img/down.png' class='CLASS02543' /></td></tr></table>");
                WriteLine("</td><td align='center' class='CLASS02544'><img src='/ise/img/enter.png' width='40px' height='25px' class='CLASS02543' /></td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</div>");
        WriteLine("</td>");

        WriteLine("<td class='CLASS02529'>");
          WriteLine("<table width='100%' height='100%' cellspacing='10'>");
            WriteLine("<tr><td><div id='"#chnId#"On'  class='ControlBtnOn CLASS02545 j_translate'>${actionStatusControlLblOn}</div></td></tr>");
            WriteLine("<tr><td><div id='"#chnId#"Off' class='ControlBtnOff CLASS02545 j_translate'>${actionStatusControlLblOff}</div></td></tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        !****************
      WriteLine("</tr>");
      if ( (rLevelReal != -1.0) && (user.UserEasyLinkMode() != true) ) {
        WriteLine("<tr>");
          WriteLine("<td><div class='ControlBtnInfo j_translate' style='color:white'>${lblInfoDimmerLevelReal}: "#sLevelReal.StrValueByIndex(".",0)#"%</div></td>")
        WriteLine("</tr>");
      }
    WriteLine("</table>");
  WriteLine("</td>");

  string sCtrlId = "slidCtrl"#chnId;
  WriteLine("<script type='text/javascript'>");
    WriteLine("ibd"#chnId#" = new iseButtonsDimmer("#chnId#", "#iState#", "#iLvlDpId#", "#iOldLvlDpId#", "#system.GetVar("iStatusOnly")#", "#system.GetVar('bSliderFlag')#");");

    Write("jQuery('#"#chnId#"Off').html(translateKey('actionStatusControlLblOff')).show();");
    Write("jQuery('#"#chnId#"On').html(translateKey('actionStatusControlLblOn')).show();");
  WriteLine("</script>");
  
  return;
}

function ::CreateThermostat()
{
  integer iLvlDpId = 0;
  real rState = 0;
  real rMin = 6;
  real rMax = 30;
  string sUnit = "&deg;<i>C</i>";
  integer iReadOnlyState = 0;

  object oLevel = cObj.DPByControl("TEMP.SETPOINT");
  if( oLevel )
  {
    iLvlDpId = oLevel.ID();
    rState = oLevel.Value(); 
    sUnit = oLevel.ValueUnit();
    if (sUnit == 'degree')
    {
      sUnit = "&deg;<i>C</i>";
    }
    rMin = oLevel.MetaData("MIN").ToFloat();
    rMax = oLevel.MetaData("MAX").ToFloat();
  }
  string sReadOnly = "";
  
  integer iInvalidState = 0;
   
  if( ( system.GetVar("iStatusOnly" ) == 1) || iInvalidState )
  {
    sReadOnly = "disabled";
    iReadOnlyState = 1;
  }
  WriteLine("<td colspan='3' id='slidCtrl"#cObj.ID()#"' class='CLASS02529'></td>");
  WriteLine("<td class='CLASS02529'>");
  WriteLine("  <div id='button"#chnId#"' class='PercBtn' >");
  WriteLine("  <table width='100%' height='100%' class='CLASS02530'>");
  WriteLine("    <tr class='CLASS02531'>");
  WriteLine("      <td colspan='2' class='CLASS02546'><input id='"#chnId#"Deg' type='text' value='"#rState.ToString(2)#"' size='3' class='CLASS02542' "#sReadOnly#" /><b>"#sUnit#"</b></td></tr>");
  WriteLine("      <input id='"#chnId#"Perc' type='hidden' value='"#rState.ToString(2)#"' />");
  WriteLine("      <td align='center' class='CLASS02548'>");
  WriteLine("      <table cellspacing='0' cellpadding='0'><tr><td><img id='"#chnId#"Up' height='12px' width='40px' src='/ise/img/up.png' class='CLASS02543' /></td></tr><tr><td><img id='"#chnId#"Down' height='12px' width='40px' src='/ise/img/down.png' class='CLASS02543' /></td></tr></table>");
  WriteLine("      </td><td align='center' class='CLASS02548'><img src='/ise/img/enter.png' width='40px' height='25px' class='CLASS02543' /></td>");
  WriteLine("    </tr>");
  WriteLine("  </table>");
  WriteLine("  </div>");
  WriteLine("</td>");
  WriteLine("<td width='35%'>&nbsp;</td>");
  string sCtrlId = "slidCtrl"#chnId;
  WriteLine("<script type='text/javascript'>");
  WriteLine("its"#chnId#" = new iseThermostat("#chnId#", "#rState#", "#iLvlDpId#", "#rMin#", "#rMax#", " #system.GetVar("iReadOnlyState")#", "#system.GetVar('bSliderFlag')#");");
  WriteLine("</script>");
  
  return;
}

function ::CreateFrequency()
{
  integer iLvlDpId = 0;
  integer iState = 0;
  integer iMin = 0;
  integer iMax = 50000;
  string sUnit = "<i>mHz</i>";
  integer iReadOnlyState = 0;

  object oFreq = cObj.DPByControl("DIGITAL_ANALOG_OUTPUT.FREQUENCY");
  
  if( oFreq )
  {
    iLvlDpId = oFreq.ID();
    iState = oFreq.Value();
    sUnit = oFreq.ValueUnit();
    iMin = oFreq.MetaData("MIN").ToInteger();
    iMax = oFreq.MetaData("MAX").ToInteger();
  }
  
  iMax = oFreq.ValueMax();

  string sReadOnly = "";
  
  integer iInvalidState = 0;
   
  if( ( system.GetVar("iStatusOnly" ) == 1) || iInvalidState )
  {
    sReadOnly = "disabled";
    iReadOnlyState = 1;
  }
  WriteLine("<td colspan='3' id='slidCtrl"#cObj.ID()#"' class='CLASS02529'></td>");
  WriteLine("<td class='CLASS02529'>");
    WriteLine("  <div id='button"#chnId#"' class='PercBtn' >");
    WriteLine("  <table width='100%' height='100%' class='CLASS02530'>");
    WriteLine("    <tr class='CLASS02531'>");
    WriteLine("      <td colspan='2' class='CLASS02546'><input id='"#chnId#"Deg' type='text' value='"#iState.ToString(2)#"' size='8' class='CLASS02542' "#sReadOnly#" /><b>"#sUnit#"</b></td></tr>");
    WriteLine("      <input id='"#chnId#"Perc' type='hidden' value='"#iState.ToString(2)#"' />");
    WriteLine("      <td align='center' class='CLASS02548'>");
    WriteLine("      <table cellspacing='0' cellpadding='0'><tr><td><img id='"#chnId#"Up' height='12px' width='40px' src='/ise/img/up.png' class='CLASS02543' /></td></tr><tr><td><img id='"#chnId#"Down' height='12px' width='40px' src='/ise/img/down.png' class='CLASS02543' /></td></tr></table>");
    WriteLine("      </td><td align='center' class='CLASS02548'><img src='/ise/img/enter.png' width='40px' height='25px' class='CLASS02543' /></td>");
    WriteLine("    </tr>");
    WriteLine("  </table>");
    WriteLine("  </div>");
  WriteLine("</td>");
  WriteLine("<td width='35%'>&nbsp;</td>");
  string sCtrlId = "slidCtrl"#chnId;
  WriteLine("<script type='text/javascript'>");
  WriteLine("ifs"#chnId#" = new iseFrequency("#chnId#", "#iState#", "#iLvlDpId#", "#iMin#", "#iMax#", " #system.GetVar("iReadOnlyState")#", "#system.GetVar('bSliderFlag')#");");
  WriteLine("</script>");
  
  return;
}

! ### CAPACITIVE FILLING SENSOR  ###
function ::CreateCapacitiveFillingSensor()
{
  ! WriteLine("<script>conInfo('Within Control CAPACITIVE FILLING SENSOR');</script>" );
  string sEnum = "";
  string sParamName = "";
  integer sFillingLevel = "0";

  sEnum = cObj.DPs().EnumEnabledVisibleIDs();
  WriteLine('<script>conInfo("enum: '#sEnum#'");</script>' );

  WriteLine("<td class='CLASS02519'>");
  WriteLine("<table cellspacing='10'>");
  
  string s;
  foreach( s, sEnum )
  {
    object oDP = dom.GetObject( s );
    if( oDP )
    {
      var value = oDP.Value();
      
      string sUnit = oDP.ValueUnit();
      sParamName = web.webKeyFromStringTable( "CAPACITIVE_FILLING_LEVEL_SENSOR|"#oDP.HSSID() );
      if (!sParamName) 
      {
        sParamName = oDP.HSSID();
      }
      WriteLine("<tr>");
        WriteLine("<td>");
          WriteLine("<div class='ControlBtnInfo CLASS02532'>"#sParamName#": "#value#""#sUnit#"</div>");
        WriteLine("</td>");
      WriteLine("</tr>");

      if (oDP.HSSID() == "FILLING_LEVEL")
      {
       sFillingLevel = value; 
      }

    }
  }
    
  object oDevice = dom.GetObject(cObj.Device());
  object oChannel = dom.GetObject(oDevice.Channels().GetAt(1));
  ! WriteLine('conInfo("Interface: '#oChannel.Interface()#'");' );
 
  ! ToDo - check why the next line doesn´t work 
  !string sCalculateFillingLevel = web.webKeyFromStringTable( "CAPACITIVE_FILLING_LEVEL_SENSOR|CONTROLTEXT_CALC_FILLINGLEVEL" );
  
  !string sCalculateFillingLevel = "Berechne Füllmenge...";
  
  WriteLine("<tr>");
    WriteLine("<td>");
      !WriteLine("<div id='volume' class='ControlBtnInfo CLASS02532'>"#sCalculateFillingLevel#"</div>");
      WriteLine("<div id='volume' class='ControlBtnInfo CLASS02532'></div>");
    WriteLine("</td>");
  WriteLine("</tr>");
  WriteLine("</table>");
  WriteLine("</td>");

  string address = oChannel.Address();
  WriteLine("<script>");
    WriteLine("$('volume').innerHTML = translateKey('infoStatusControlCalculateFillingLevel');");
    WriteLine("var address = '"#address#"';");
    WriteLine("var BidCosRF = 'BidCos-RF';");
    WriteLine("var volume;");
    WriteLine('var caseDesign = homematic("Interface.getMasterValue", {"interface": BidCosRF, "address": address, "valueKey": "CASE_DESIGN"});');
    WriteLine('var caseHeight = homematic("Interface.getMasterValue", {"interface": BidCosRF, "address": address, "valueKey": "CASE_HIGH"});');
    WriteLine('var caseWidth = homematic("Interface.getMasterValue", {"interface": BidCosRF, "address": address, "valueKey": "CASE_WIDTH"});');
    WriteLine('var fillingLevel = '#sFillingLevel#';');
   
    ! WriteLine('conInfo("caseDesign: " + caseDesign);');
    ! WriteLine('conInfo("caseHeight: " + caseHeight);');
    ! WriteLine('conInfo("caseWidth: " + caseWidth);');
    
    WriteLine('switch(caseDesign){');
      WriteLine("case '0':");
        WriteLine('var caseRadius = caseWidth / 2;');
        WriteLine('var v1 = Math.PI * Math.pow(caseRadius, 2) * (caseHeight * (fillingLevel / 100));'); 
        WriteLine('volume = Math.round(v1 / 1000) + " Liter";');
        WriteLine('break;');
      WriteLine("case '1':");
        WriteLine('var fillLevel = homematic("Interface.getMasterValue", {"interface": BidCosRF, "address": address, "valueKey": "FILL_LEVEL"});');
        WriteLine('var caseRadius = caseHeight / 2;');
        !WriteLine('var fillingHeight = fillLevel * (fillingLevel / 100)');
        ! WriteLine("var v2 = Math.pow(caseRadius, 2) * caseWidth * (Math.acos((caseRadius - fillingHeight) / caseRadius) - (caseRadius - fillingHeight) * (Math.sqrt((2 * caseRadius * fillingHeight) - Math.pow(fillingHeight,2)) / Math.pow(caseRadius,2)))  ;"); 
        WriteLine("var v100Percent = Math.pow(caseRadius, 2) * caseWidth * (Math.acos((caseRadius - fillLevel) / caseRadius) - (caseRadius - fillLevel) * (Math.sqrt((2 * caseRadius * fillLevel) - Math.pow(fillLevel,2)) / Math.pow(caseRadius,2)))  ;"); 
        WriteLine("var v2 = v100Percent * (fillingLevel / 100)  ;"); 
        WriteLine('volume = Math.round(v2 / 1000) + " Liter";');
        WriteLine('break;');
      WriteLine("case '2':");
        WriteLine('var caseLength = homematic("Interface.getMasterValue", {"interface": BidCosRF, "address": address, "valueKey": "CASE_LENGTH"});');
        WriteLine('var v3 = (caseHeight * (fillingLevel / 100)) * caseWidth * caseLength;'); 
        WriteLine('volume = Math.round(v3 / 1000) + " Liter";');
        WriteLine('break;');
    WriteLine('}');     
    
    ! ToDo - check why the next line doesn´t work 
    ! string sFillingLevel = web.webKeyFromStringTable( "CAPACITIVE_FILLING_LEVEL_SENSOR|CONTROLTEXT_FILLINGLEVEL" );
    
    !WriteLine("$('volume').innerHTML = 'Füllmenge:&nbsp;' + volume;");
    WriteLine("$('volume').innerHTML = translateKey('infoStatusControlFillingLevel') + '&nbsp;' + volume;");

  WriteLine("</script>");
 
  
  return;
}

! ### DOOR WINDOW CONTACT ###
function ::CreateDoorWindowContact()
{
  WriteLine("<td>");
    WriteLine("<table class='ControlBtnOff CLASS02514' id='"#chnId#"Open' >"); 
    WriteLine("<tr>");
      WriteLine("<td class='CLASS02513'>");
        WriteLine("<div align='center'>");
          WriteLine("<img src='/ise/img/door/open.png' width='80' height='80' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    !WriteLine("<tr><td>Offen</td></tr>");
    WriteLine("<tr><td id='"#chnId#"txtOpen' class='j_translate' >${infoStatusControlLblOpen}</td></tr>");
    WriteLine("</table>");
  WriteLine("</td>");
  WriteLine("<td>");
    WriteLine("<table class='ControlBtnOff CLASS02514' id='"#chnId#"Closed' >"); 
    WriteLine("<tr>");
      WriteLine("<td  class='CLASS02513'>");
        WriteLine("<div align='center'>");
          WriteLine("<img src='/ise/img/door/closed.png' width='80px' height='80px' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    !WriteLine("<tr><td>Verschlossen</td></tr>");
    WriteLine("<tr><td id='"#chnId#"txtClosed' class='j_translate' >${infoStatusControlLblClosed}</td></tr>");
    WriteLine("</table>");
  WriteLine("</td>");
  WriteLine("<td></td><td></td><td></td>");
  object objState = cObj.DPByControl("DOOR_SENSOR.STATE"); 
  WriteLine("<script type='text/javascript'>");
    WriteLine("ibdc"#cObj.ID()#" = new iseButtonsDoorContact("#chnId#", "#objState.Value()#");");
    Write("jQuery('#"#chnId#"txtClosed').text(translateKey('infoStatusControlLblClosed')).show();");
    Write("jQuery('#"#chnId#"txtOpen').text(translateKey('infoStatusControlLblOpen')).show();");
  WriteLine("</script>");
  return;
}


function ::CreateShutterActuator()
{
  object oLvl = cObj.DPByControl("BLIND.LEVEL");
  object oStop = cObj.DPByControl("BLIND.STOP");
  integer oLvlId = 0;
  integer oStopId = 0;
  integer iLvl = 0;
  if (oLvl)
  {
    oLvlId = oLvl.ID();
    iLvl = oLvl.Value();
    if( oLvl.ValueUnit() == "100%" )
    {
      iLvl = iLvl * 100;
    }
  }
  if (oStop)
  {
    oStopId = oStop.ID();
  }

  WriteLine("<td colspan='2' id='shutter"#chnId#"' class='CLASS02549' >&nbsp;</td>");
  WriteLine("<td>");
    WriteLine("  <div class='PercBtn'>");
    WriteLine("  <table width='100%' height='100%'>");
    WriteLine("    <tr class='CLASS02531'>");
    string sReadOnly = "";
    if (system.GetVar("iStatusOnly")) {
      sReadOnly = "readonly";
    }
    WriteLine("      <td colspan='2' class='CLASS02546'><input id='"#chnId#"Perc' type='text' value='0' size='3' class='CLASS02542' "#sReadOnly#" /><b>%</b></td></tr>");
    WriteLine("    <tr>");
    WriteLine("      <td align='center'>");
    WriteLine("      <table cellspacing='0' cellpadding='0'><tr><td><img id='"#chnId#"PercUp' height='12px' width='40px' src='/ise/img/up.png' class='CLASS02543'/></td></tr><tr><td><img id='"#chnId#"PercDown' height='12px' width='40px' src='/ise/img/down.png' class='CLASS02543' /></td></tr></table>");
    WriteLine("      </td><td align='center'><img src='/ise/img/enter.png' width='40px' height='25px' class='CLASS02543' /></td>");
    WriteLine("    </tr>");
    WriteLine("  </table>");
    WriteLine("  </div>");
  WriteLine("</td>");

  WriteLine("<td>");
    ! WriteLine("<div class='ControlBtnOff CLASS02550' id='"#chnId#"Stop' >Stopp</div>");
    WriteLine("<div class='ControlBtnOff CLASS02550' id='"#chnId#"Stop' >${actionStatusControlStop}</div>");
  WriteLine("</td>");
  WriteLine("<td>");
    WriteLine("<table width='100%' height='100%' cellspacing='10'>");
      WriteLine("<tr>");
        WriteLine("<td>");
          WriteLine("<table class='ControlBtnOff CLASS02551' id='"#chnId#"Up' >");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<img src='/ise/img/up.png' width='40' height='30' class='CLASS02552' />");
              WriteLine("</td>");
              WriteLine("<td>");
                ! WriteLine("Auf");
                WriteLine("${actionStatusControlUp}");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
      WriteLine("</tr>");
      WriteLine("<tr>");
        WriteLine("<td>");
          WriteLine("<table class='ControlBtnOff CLASS02551' id='"#chnId#"Down'>");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<img src='/ise/img/down.png' width='40' height='30' class='CLASS02552' />");
              WriteLine("</td>");
              WriteLine("<td>");
                !WriteLine("Ab");
                WriteLine("${actionStatusControlDown}");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
      WriteLine("</tr>");
    WriteLine("</table>");
  WriteLine("</td>");

  string sCtrlId = "shutter"#chnId;
  WriteLine("<script type='text/javascript'>");
  WriteLine("ibs"#cObj.ID()#" = new iseButtonsShutter(" # chnId # ", " # iLvl # ", " # oLvlId # ", " # oStopId # ", " #system.GetVar("iStatusOnly")# " );" );
  WriteLine("translatePage('#ctrl"#chnId#"tbl');");
  WriteLine("</script>");
  return;
}

function ::CreateWinMatic()
{
  object oLevel = cObj.DPByControl("WINDOW.LEVEL");
  object oUncertain = cObj.DPByControl("WINDOW.UNCERTAIN"); 
  object oStop = cObj.DPByControl("WINDOW.STOP"); 

  WriteLine("<td id='"#chnId#"Circle'></td>");
  WriteLine("<td>");
    WriteLine("<div class='PercBtn' >");
      WriteLine("<table width='100%'>");
        WriteLine("<tr class='CLASS02531'>");
          string sReadOnly = "";
          if( system.GetVar("iStatusOnly") )
          {
            sReadOnly = "readonly";
          }
          WriteLine("<td colspan='2' class='CLASS02546'><input id='"#chnId#"Perc' type='text' value='0' size='3' class='CLASS02542' "#sReadOnly#" /><b>%</b></td></tr>");
        WriteLine("<tr>");
          WriteLine("<td align='center'>");
          WriteLine("<table cellspacing='0' cellpadding='0'><tr><td><img id='"#chnId#"PercUp' height='12px' width='40px' src='/ise/img/up.png' class='CLASS02543'/></td></tr><tr><td><img id='"#chnId#"PercDown' height='12px' width='40px' src='/ise/img/down.png' class='CLASS02543' /></td></tr></table>");
          WriteLine("</td><td align='center'><img src='/ise/img/enter.png' width='40px' height='25px' class='CLASS02543' /></td>");
        WriteLine("</tr>");
      WriteLine("</table>");
    WriteLine("</div>");
  WriteLine("</td>");
  
  WriteLine("<td>");
    WriteLine("<div class='ControlBtnOff CLASS02550' id='"#chnId#"Stop' >${actionStatusControlStop}</div>");
  WriteLine("</td>");
  
  WriteLine("<td>");
    WriteLine("<table width='100%' height='100%' cellspacing='4'>");
      WriteLine("<tr>");
        WriteLine("<td>");
          WriteLine("<table class='ControlBtnOff CLASS02551' id='"#chnId#"Open' >");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<img src='/ise/img/window/open_v.png' width='40' height='30' class='CLASS02552' />");
              WriteLine("</td>");
              WriteLine("<td>");
                WriteLine("${actionStatusControlOpen}");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
      WriteLine("</tr>");
      WriteLine("<tr>");
        WriteLine("<td>");
          WriteLine("<table class='ControlBtnOff CLASS02551' id='"#chnId#"Close' >");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<img src='/ise/img/window/closed.png' width='40' height='30' class='CLASS02552' />");
              WriteLine("</td>");
              WriteLine("<td>");
                WriteLine("${actionStatusControlClose}");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
      WriteLine("</tr>");
    WriteLine("</table>");
  WriteLine("</td>");
  
  WriteLine("<td>");
    WriteLine("<table width='100%' height='100%' cellspacing='5'>");
      WriteLine("<tr>");
        WriteLine("<td>");
        
          WriteLine("<table class='ControlBtnOff CLASS02554' id='"#chnId#"Locked' >");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<img src='/ise/img/lock/closed.png' width='40' height='30' class='CLASS02552' />");
              WriteLine("</td>");
              WriteLine("<td class='CLASS02555' >");
                WriteLine("${actionStatusControlLocked}");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
      WriteLine("</tr>");
      WriteLine("<tr>");
        WriteLine("<td>");
          WriteLine("<div class='ControlBtnOff CLASS02556' id='"#chnId#"Unknown'>${infoStatusControlStateUnknown}</div>");
        WriteLine("</td>");
      WriteLine("</tr>");
    WriteLine("</table>");
  WriteLine("</td>");
  
  if( oLevel && oUncertain && oStop )
  {
    string sCtrlId = chnId#"Circle";
    WriteLine('<script type="text/javascript">');

      WriteLine("var opts = {");
      WriteLine(" idLevel: "#oLevel.ID()#",");
      WriteLine(" idStop: "#oStop.ID()#",");
      WriteLine(" idUncertain: "#oUncertain.ID()#",");
      WriteLine(" stLevel: "#oLevel.Value()#",");
      WriteLine(" stStop: '"#oStop.Value()#"',");
      WriteLine(" stUncertain: "#oUncertain.Value());
      WriteLine("};");

      WriteLine("ibwm"#cObj.ID()#" = new iseButtonsWinMatic("#cObj.ID()#", opts, " #system.GetVar("iStatusOnly")# ");");
      !WriteLine("new iseButtonsWinMatic("#cObj.ID()#", 0, false);");
      WriteLine("translatePage('#ctrl"#chnId#"tbl');");
    WriteLine('</script>');   
  }
  return;
}

function ::CreateWin_SC()
{
  object oLevel = cObj.DPByControl("WIN_SC.LEVEL");
  object oStop = cObj.DPByControl("WIN_SC.STOP");
  object oLEDMode = cObj.DPByControl("WIN_SC.HANDLE_LED_MODE");
  object oWinterMode = cObj.DPByControl("WIN_SC.WINTER_MODE");
  object oHandleLock = cObj.DPByControl("WIN_SC.HANDLE_LOCK");
  object oRelease = cObj.DPByControl("WIN_SC.RELEASE");


  WriteLine("<tr>");
    WriteLine("<td>");
      WriteLine("<table>");
        WriteLine("<tr>");
          WriteLine("<td id='"#chnId#"Circle'></td>");
          WriteLine("<td>");
            WriteLine("<div class='PercBtn' style='float:left'>");
              WriteLine("<table width='100%'>");
                WriteLine("<tr class='CLASS02531'>");
                  string sReadOnly = "";
                  if( system.GetVar("iStatusOnly") )
                  {
                    sReadOnly = "readonly";
                  }
                  WriteLine("<td colspan='2' class='CLASS02546'><input id='"#chnId#"Perc' type='text' value='0' size='3' class='CLASS02542 j_winSC_Perc' "#sReadOnly#" /><b>%</b></td>");
                WriteLine("</tr>");
                WriteLine("<tr>");
                   WriteLine("<td align='center'>");
                  WriteLine("<table cellspacing='0' cellpadding='0'><tr><td><img id='"#chnId#"PercUp' height='12px' width='40px' src='/ise/img/up.png' class='CLASS02543'/></td></tr><tr><td><img id='"#chnId#"PercDown' height='12px' width='40px' src='/ise/img/down.png' class='CLASS02543' /></td></tr></table>");
                  WriteLine("</td><td align='center'><img src='/ise/img/enter.png' width='40px' height='25px' class='CLASS02543' /></td>");
                WriteLine("</tr>");
              WriteLine("</table>");
            WriteLine("</div>");
          WriteLine("</td>");


          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<table class='ControlBtnOff CLASS02550a j_winSC_Open' id='"#chnId#"Open' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<img src='/ise/img/window/open_v.png' width='40' height='30' class='CLASS02552' />");
                      WriteLine("</td>");
                      WriteLine("<td style='text-align:left'>");
                        WriteLine("${actionStatusControlOpen}");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<table class='ControlBtnOff CLASS02550a j_winSC_Close' id='"#chnId#"Close' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<img src='/ise/img/window/closed.png' width='40' height='30' class='CLASS02552' />");
                      WriteLine("</td>");
                      WriteLine("<td style='text-align:left'>");
                        WriteLine("${actionStatusControlClose}");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");


          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
              WriteLine("<tr>");
               WriteLine("<td>");
                  WriteLine("<table class='ControlBtnOff CLASS02550a' id='"#chnId#"Stop' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<div>${actionStatusControlStop}</div>");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<table class='ControlBtnOff CLASS02550a j_winSC_Release' id='"#chnId#"Release' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<img src='/ise/img/window/open_h.png' width='40' height='30' class='CLASS02552' />");
                      WriteLine("</td>");
                      WriteLine("<td style='text-align:left'>");
                        WriteLine("${actionStatusControlReleased}");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");

        ! new table row
        WriteLine("<tr>");
          WriteLine("<td colspan='2'>");
            WriteLine("<table width='215px' _height='100%' cellspacing='4'>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<div class='ControlBtnOff _CLASS02550a' style='line-height:17px;' id='"#chnId#"SummerMode' >${actionStatusControlSummerMode}</div>");
                WriteLine("</td>");
              WriteLine("</tr>");

              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<div class='ControlBtnOff _CLASS02550a' style='line-height:17px;' id='"#chnId#"WinterMode' >${actionStatusControlWinterMode}</div>");
                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");

          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  !WriteLine("<div class='ControlBtnOff CLASS02550a' style='height:17px; line-height:17px;' id='"#chnId#"LEDMode1' >${actionStatusControlLEDModeOff}</div>");
                  WriteLine("<table class='ControlBtnOff CLASS02551a' style='height:17px; line-height:17px;' id='"#chnId#"LEDMode1' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                      WriteLine("<div>${actionStatusControlLEDModeOff}</div>");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  !WriteLine("<div class='ControlBtnOff CLASS02550a' style='height:17px; line-height:17px;' id='"#chnId#"LEDMode2' >${actionStatusControlLEDModeDim}</div>");
                  WriteLine("<table class='ControlBtnOff CLASS02551a' style='height:17px; line-height:17px;' id='"#chnId#"LEDMode2' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                      WriteLine("<div>${actionStatusControlLEDModeDim}</div>");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  !WriteLine("<div class='ControlBtnOff CLASS02550a' style='height:17px; line-height:17px;' id='"#chnId#"LEDMode3' >${actionStatusControlLEDModeOn}</div>");
                  WriteLine("<table class='ControlBtnOff CLASS02551a' style='height:17px; line-height:17px;' id='"#chnId#"LEDMode3' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                      WriteLine("<div>${actionStatusControlLEDModeOn}</div>");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");

         ! UNLOCK
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<table class='ControlBtnOff CLASS02551a' id='"#chnId#"HandleUnlock' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<div>${actionStatusControlHandleUnlock}</div>");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<table class='ControlBtnOff CLASS02551a' id='"#chnId#"HandleLock' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<div>${actionStatusControlHandleLock}</div>");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
               WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='5'>");
              WriteLine("<tr>");
                WriteLine("<td>");

                  WriteLine("<table class='ControlBtnOff CLASS02554 hidden' id='"#chnId#"Locked' >");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<img src='/ise/img/lock/closed.png' width='40' height='30' class='CLASS02552' />");
                      WriteLine("</td>");
                      WriteLine("<td class='CLASS02555'>");
                        WriteLine("${actionStatusControlLocked}");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");

                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");
      WriteLine("</table>");
    WriteLine("</td>");
  WriteLine("</tr>");


  if( oLevel && oStop && oLEDMode && oWinterMode && oHandleLock && oRelease)
  {
    string sCtrlId = chnId#"Circle";
    WriteLine('<script type="text/javascript">');
      WriteLine("var opts = {};");
      if(oLevel.Value()) {
        WriteLine("opts.idLevel = "#oLevel.ID()#";");
        WriteLine("opts.stLevel = "#oLevel.Value()#";");
      }
      WriteLine("opts.idStop = "#oStop.ID()#";");
      ! WriteLine("opts.stStop = "#oStop.Value()#";");
      WriteLine("opts.idLEDMode = "#oLEDMode.ID()#";");
      WriteLine("opts.stLEDMode = "#oLEDMode.Value()#";");
      WriteLine("opts.idWinterMode = "#oWinterMode.ID()#";");
      WriteLine("opts.stWinterMode = "#oWinterMode.Value()#";");
      WriteLine("opts.idHandleLock = "#oHandleLock.ID()#";");
      WriteLine("opts.stHandleLock = "#oHandleLock.Value()#";");
      WriteLine("opts.idRelease = "#oRelease.ID()#";");
      ! WriteLine("opts.stRelease = "#oRelease.Value()#";");


      WriteLine("ibwm"#cObj.ID()#" = new iseButtonsWin_SC("#cObj.ID()#", opts, " #system.GetVar("iStatusOnly")# ");");
      WriteLine("translatePage('#ctrl"#chnId#"tbl');");
    WriteLine('</script>');
  }
  return;
}

function ::CreateWin_SC_SENSOR()
{
  object oLevel = cObj.DPByControl("WIN_SC_SENSOR.LEVEL");
  object oRelease = cObj.DPByControl("WIN_SC_SENSOR.RELEASE");
  object oTipTronicState = cObj.DPByControl("WIN_SC_SENSOR.TIPTRONIC_STATE");
  object oWindowType = cObj.DPByControl("WIN_SC_SENSOR.WINDOW_TYPE");


  WriteLine("<div class='hidden' id='"#chnId#"Circle'></div>");
  WriteLine("<div class='hidden' id='"#chnId#"Stop' >${actionStatusControlStop}</div>");
  WriteLine("<input id='"#chnId#"Perc' type='text' value='0' size='3' class='hidden'/>");
  WriteLine("<img id='"#chnId#"PercUp' src='/ise/img/up.png' class='hidden'/>");
  WriteLine("<img id='"#chnId#"PercDown' src='/ise/img/down.png' class='hidden' />");

  WriteLine("<tr>");
    WriteLine("<td>");
    WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<span id='"#chnId#"windowType'>Type unknown</span>");
                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");

      WriteLine("<tr>");
        WriteLine("<td class='hidden'>");
          WriteLine("<table class='ControlBtnOff CLASS02551' id='"#chnId#"Open' >");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<img src='/ise/img/window/open_v.png' width='40' height='30' class='CLASS02552' />");
              WriteLine("</td>");
              WriteLine("<td>");
                WriteLine("${actionStatusControlOpen}");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");

        WriteLine("<td>");
          WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<img id='"#chnId#"stateIndicatorImg' src='/ise/img/window/open_h.png' width='40' height='30' class='CLASS02552' />");
              WriteLine("</td>");
              WriteLine("<td style='text-align:left'>");
                WriteLine("<span id='"#chnId#"stateIndicatorDescr'>State unknown</span>");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
      WriteLine("</tr>");

      WriteLine("<tr>");
        WriteLine("<td>");
          WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<span id='"#chnId#"stateDescr'>State unknown</span>");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");

        WriteLine("<td class='hidden'>");
          WriteLine("<table class='ControlBtnOff CLASS02551' id='"#chnId#"Close' >");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<img src='/ise/img/window/closed.png' width='40' height='30' class='CLASS02552' />");
              WriteLine("</td>");
              WriteLine("<td>");
                WriteLine("${actionStatusControlClose}");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");

      WriteLine("</tr>");
    WriteLine("</table>");
  WriteLine("</td>");

  WriteLine("<td>");
    WriteLine("<table width='100%' _height='100%' cellspacing='5'>");
      WriteLine("<tr>");
        WriteLine("<td>");
          WriteLine("<table class='ControlBtnOff CLASS02554 hidden' id='"#chnId#"Locked' >");
            WriteLine("<tr>");
              WriteLine("<td>");
                WriteLine("<img src='/ise/img/lock/closed.png' width='40' height='30' class='CLASS02552' />");
              WriteLine("</td>");
              WriteLine("<td class='CLASS02555'>");
                WriteLine("${actionStatusControlLocked}");
              WriteLine("</td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
      WriteLine("</tr>");
      !WriteLine("<tr>");
      !  WriteLine("<td>");
      !    WriteLine("<div class='ControlBtnOff CLASS02556' id='"#chnId#"Unknown'>${infoStatusControlStateUnknown}</div>");
      !  WriteLine("</td>");
      !WriteLine("</tr>");
    WriteLine("</table>");
    WriteLine("</td>");
  WriteLine("</tr>");

  if( oLevel && oRelease && oTipTronicState && oWindowType)
  {
    string sCtrlId = chnId#"Circle";
    WriteLine('<script type="text/javascript">');
      WriteLine("var opts = {};");
      WriteLine("opts.idLevel = "#oLevel.ID()#";");
      WriteLine("opts.stLevel = "#oLevel.Value()#";");
      WriteLine("opts.idRelease = "#oRelease.ID()#";");
      WriteLine("opts.stRelease = "#oRelease.Value()#";");
      WriteLine("opts.idWindowType = "#oWindowType.ID()#";");
      WriteLine("opts.stWindowType = "#oWindowType.Value()#";");
      WriteLine("opts.idTipTronicState = "#oTipTronicState.ID()#";");
      WriteLine("opts.stTipTronicState = "#oTipTronicState.Value()#";");

      WriteLine("ibwm"#cObj.ID()#" = new iseButtonsWin_SC_SENSOR("#cObj.ID()#", opts, " #system.GetVar("iStatusOnly")# ");");
      WriteLine("translatePage('#ctrl"#chnId#"tbl');");
    WriteLine('</script>');
  }
  return;
}

function ::CreateWin_SC_SECURE()
{
  object objState = cObj.DPByControl("WIN_SC_SECURE.STATE");
  if( objState )
  {
    ! WriteLine("<table width='100%' _height='100%' cellspacing='8' class='ctrlTbl CLASS02520'>");
      WriteLine("<tr>");

        WriteLine("<td class='CLASS02521'>");
        !WriteLine("<div id='"#chnId#"Off' class='ControlBtnOff CLASS02522a j_translate'>${actionStatusControlSecurityChannelOff}</div>");
           WriteLine("<table class='ControlBtnOff CLASS02522a' id='"#chnId#"Off' >");
             WriteLine("<tr>");
               WriteLine("<td>");
                WriteLine("<div>${actionStatusControlSecurityChannelOff}</div>");
               WriteLine("</td>");
             WriteLine("</tr>");
           WriteLine("</table>");
        WriteLine("</td>");

        WriteLine("<td class='CLASS02521'>");
          !WriteLine("<div id='"#chnId#"On' class='ControlBtnOff CLASS02522a j_translate'>${actionStatusControlSecurityChannelOn}</div>");
           WriteLine("<table class='ControlBtnOff CLASS02522a' id='"#chnId#"On' >");
             WriteLine("<tr>");
               WriteLine("<td>");
                WriteLine("<div>${actionStatusControlSecurityChannelOn}</div>");
               WriteLine("</td>");
             WriteLine("</tr>");
           WriteLine("</table>");
        WriteLine("</td>");
      WriteLine("</tr>");
    ! WriteLine("</table>");

    WriteLine("<script type='text/javascript'>");
      WriteLine("ibs"#cObj.ID()#" = new iseButtonsSwitch("#cObj.ID()#", "#objState.Value()#", "#objState.ID()#", " #system.GetVar("iStatusOnly")# ");");

      Write("jQuery('#"#chnId#"Off').html(translateKey('actionStatusControlSecurityChannelOff')).show();");
      Write("jQuery('#"#chnId#"On').html(translateKey('actionStatusControlSecurityChannelOn')).show();");
    WriteLine("</script>");
  }
  return;
}

function ::CreateHeatingControl()
{
  integer iLvlDpId = 0;
  real rState = 0;
  real rMin = 4.5;
  real rMax = 30.5;
  string sUnit = "&deg;<i>C</i>";
  integer iReadOnlyState = 0;

  object oControlMode = cObj.DPByControl("HEATING_CONTROL.CONTROL_MODE");
  object oLevel = cObj.DPByControl("HEATING_CONTROL.SETPOINT");
  object oTemperature = cObj.DPByControl("HEATING_CONTROL.TEMPERATURE");
  object oModeAuto = cObj.DPByControl("HEATING_CONTROL.AUTO");
  object oModeManu = cObj.DPByControl("HEATING_CONTROL.MANU");
  object oModeBoost = cObj.DPByControl("HEATING_CONTROL.BOOST");
  object oModeComfort = cObj.DPByControl("HEATING_CONTROL.COMFORT");
  object oModeLowering = cObj.DPByControl("HEATING_CONTROL.LOWERING");

  object oPartyTemp = cObj.DPByControl("HEATING_CONTROL.PARTY_TEMP");
  object oPartyStartTime = cObj.DPByControl("HEATING_CONTROL.PARTY_START_TIME");
  object oPartyStartDay = cObj.DPByControl("HEATING_CONTROL.PARTY_START_DAY");
  object oPartyStartMonth = cObj.DPByControl("HEATING_CONTROL.PARTY_START_MONTH");
  object oPartyStartYear = cObj.DPByControl("HEATING_CONTROL.PARTY_START_YEAR");
  object oPartyStopTime = cObj.DPByControl("HEATING_CONTROL.PARTY_STOP_TIME");
  object oPartyStopDay = cObj.DPByControl("HEATING_CONTROL.PARTY_STOP_DAY");
  object oPartyStopMonth = cObj.DPByControl("HEATING_CONTROL.PARTY_STOP_MONTH");
  object oPartyStopYear = cObj.DPByControl("HEATING_CONTROL.PARTY_STOP_YEAR");


  ! WriteLine(' <script>conInfo("oControlMode: '#oControlMode.Value()#'");</script> ');

  if ( oTemperature )
  {
    ! WriteLine(' <script>conInfo("oTemperature: '#oTemperature.Value()#'");</script> ');
    actTemp = oTemperature.Value();
  }

  if( oLevel )
  {
    iLvlDpId = oLevel.ID();
    rState = oLevel.Value();
    sUnit = oLevel.ValueUnit();
    if (sUnit == 'degree')
    {
      sUnit = "&deg;<i>C</i>";
    }
    ! rMin = oLevel.MetaData("MIN").ToFloat();
    ! rMax = oLevel.MetaData("MAX").ToFloat();
  }
  string sReadOnly = "";

  integer iInvalidState = 0;

  if( ( system.GetVar("iStatusOnly" ) == 1) || iInvalidState )
  {
    sReadOnly = "disabled";
    iReadOnlyState = 1;
  }

  WriteLine("<tr>");
    WriteLine("<td>");
      WriteLine("<table id='"#chnId#"tblShowTemp' class='ControlBtnInfo hidden' style='width:200px'>");
        WriteLine("<tr>");
          WriteLine("<td>${stringTableWeatherTemperature}</td>");
          WriteLine("<td><span id='"#chnId#"actTemp'></span><span><b>"#sUnit#"</b></span></td>");
        WriteLine("</tr>");
      WriteLine("</table>");
      !WriteLine("<div class='ControlBtnInfo _CLASS02550' style='line-height:15px; min-width:200px' id='"#chnId#"actualTemp' ><span>${stringTableWeatherTemperature}</span><span id='actTemp'"#sUnit#"></span></div>");
    WriteLine("</td>");
  WriteLine("</tr>");

  WriteLine("<tr>");
    WriteLine("<td colspan='1' id='slidCtrl"#cObj.ID()#"' class='CLASS02529'></td>");
    WriteLine("<td class='CLASS02529'>");
    WriteLine("  <div id='button"#chnId#"' class='PercBtn' >");
    WriteLine("  <table width='100%' height='100%' class='CLASS02530'>");
    WriteLine("    <tr class='CLASS02531'>");
    WriteLine("      <td colspan='2' class='CLASS02546'><input id='"#chnId#"Deg' type='text' value='"#rState.ToString(2)#"' size='4' class='CLASS02542' style='text-align:center' "#sReadOnly#" /><span id='"#chnId#"unitDegree'><b>"#sUnit#"</b></span></td></tr>");
    WriteLine("      <input id='"#chnId#"Perc' type='hidden' value='"#rState.ToString(2)#"' />");
    WriteLine("      <td align='center' class='CLASS02548'>");
    WriteLine("      <table cellspacing='0' cellpadding='0'><tr><td><img id='"#chnId#"Up' height='12px' width='40px' src='/ise/img/up.png' class='CLASS02543' /></td></tr><tr><td><img id='"#chnId#"Down' height='12px' width='40px' src='/ise/img/down.png' class='CLASS02543' /></td></tr></table>");
    WriteLine("      </td><td align='center' class='CLASS02548'><img src='/ise/img/enter.png' width='40px' height='25px' class='CLASS02543' /></td>");
    WriteLine("    </tr>");
    WriteLine("  </table>");
    WriteLine("  </div>");
    WriteLine("</td>");
  WriteLine("</tr>");

  WriteLine("<tr>");
    WriteLine("<td>");
      WriteLine("<table id='tblChangeMode"#chnId#"' width='100%' height='100%' class='hidden'>");
        WriteLine("<tr>");
          WriteLine("<td>");
            ! AUTO
            WriteLine("<div class='ControlBtnOff CLASS02551' id='"#chnId#"mode0' >${stringTableClimateControlRTTransceiverAutoModeBR}</div>");
          WriteLine("</td>");
          WriteLine("<td>");
            ! BOOST
            WriteLine("<div class='ControlBtnOff CLASS02551' id='"#chnId#"mode3' >${stringTableClimateControlRTTransceiverBoostModeBR}</div>");
          WriteLine("</td>");
        WriteLine("</tr>");
        WriteLine("<tr>");
          WriteLine("<td>");
            ! MANU
            WriteLine("<div class='ControlBtnOff CLASS02551' id='"#chnId#"mode1' >${stringTableClimateControlRTTransceiverManuModeBR}</div>");
          WriteLine("</td>");
          WriteLine("<td>");
            ! PARTY
            WriteLine("<div class='ControlBtnOff CLASS02551 hidden' id='"#chnId#"mode2' >${stringTableClimateControlRTTransceiverPartyModeBR}</div>");
          WriteLine("</td>");
        WriteLine("</tr>");
      WriteLine("</table>");
    WriteLine("</td>");

    WriteLine("<td>");
      WriteLine("<table>");
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<div class='ControlBtnOff CLASS02551 hidden' style='line-height:35px' id='"#chnId#"modeOFF' name='panelOnOff'>${actionStatusControlLblOff}</div>");
          WriteLine("</td>");
          WriteLine("<td>");
            WriteLine("<div class='ControlBtnOff CLASS02551 hidden' id='"#chnId#"tempECO' name='panelComfortEco'>${stringTableClimateControlRTTransceiverLoweringModeBR}</div>");
          WriteLine("</td>");
        WriteLine("</tr>");
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<div class='ControlBtnOff CLASS02551 hidden' style='line-height:35px' id='"#chnId#"modeON' name='panelOnOff'>${actionStatusControlLblOn}</div>");
          WriteLine("</td>");
          WriteLine("<td>");
            WriteLine("<div class='ControlBtnOff CLASS02551 hidden' id='"#chnId#"tempCOMFORT' name='panelComfortEco'>${stringTableClimateControlRTTransceiverComfortModeBR}</div>");
          WriteLine("</td>");
        WriteLine("</tr>");
      WriteLine("</table>");
    WriteLine("</td>");
  WriteLine("</tr>");

    WriteLine("<tr>");
      WriteLine("<td colspan='2'>");
        WriteLine("<table id='"#chnId#"showPartyEnd' class='ControlBtnInfo hidden' style='background-color:#3678C9; min-width:200px; width:100%'>");
          WriteLine("<tr>");
            WriteLine("<td><div>${partyModeEndTime}</div><div id='"#chnId#"partyEndTime'></div></td>");
          WriteLine("</tr>");
        WriteLine("</table>");
      WriteLine("</td>");
    WriteLine("</tr>");

  string sCtrlId = "slidCtrl"#chnId;
  WriteLine("<script type='text/javascript'>");
    WriteLine("var opts = {};");
    WriteLine("opts.idLevel = "#oLevel.ID()#";");
    WriteLine("opts.stLevel = "#oLevel.Value()#";");
    WriteLine("opts.idControlMode = "#oControlMode.ID()#";");
    WriteLine("opts.stControlMode = "#oControlMode.Value()#";");
    if (oModeAuto) {WriteLine("opts.idAuto = "#oModeAuto.ID()#";");}
    if (oModeManu) {WriteLine("opts.idManu = "#oModeManu.ID()#";");}
    if (oModeBoost) {WriteLine("opts.idBoost = "#oModeBoost.ID()#";");}
    if (oModeComfort) {WriteLine("opts.idComfort = "#oModeComfort.ID()#";");}
    if (oModeLowering) {WriteLine("opts.idLowering = "#oModeLowering.ID()#";");}

    if (oPartyTemp) {WriteLine("opts.idPartyTemp = "#oPartyTemp.ID()#";");
    WriteLine("opts.stPartyTemp = "#oPartyTemp.Value()#";");}
    if (oPartyStartTime) {WriteLine("opts.idPartyStartTime = "#oPartyStartTime.ID()#";");
    WriteLine("opts.stPartyStartTime = "#oPartyStartTime.Value()#";");}
    if (oPartyStartDay) {WriteLine("opts.idPartyStartDay = "#oPartyStartDay.ID()#";");
    WriteLine("opts.stPartyStartDay = "#oPartyStartDay.Value()#";");}
    if (oPartyStartMonth) {WriteLine("opts.idPartyStartMonth = "#oPartyStartMonth.ID()#";");
    WriteLine("opts.stPartyStartMonth = "#oPartyStartMonth.Value()#";");}
    if (oPartyStartYear) {WriteLine("opts.idPartyStartYear = "#oPartyStartYear.ID()#";");
    WriteLine("opts.stPartyStartYear = "#oPartyStartYear.Value()#";");}
    if (oPartyStopTime) {WriteLine("opts.idPartyStopTime = "#oPartyStopTime.ID()#";");
    WriteLine("opts.stPartyStopTime = "#oPartyStopTime.Value()#";");}
    if (oPartyStopDay) {WriteLine("opts.idPartyStopDay = "#oPartyStopDay.ID()#";");
    WriteLine("opts.stPartyStopDay = "#oPartyStopDay.Value()#";");}
    if (oPartyStopMonth) {WriteLine("opts.idPartyStopMonth = "#oPartyStopMonth.ID()#";");
    WriteLine("opts.stPartyStopMonth = "#oPartyStopMonth.Value()#";");}
    if (oPartyStopYear) {WriteLine("opts.idPartyStopYear = "#oPartyStopYear.ID()#";");
    WriteLine("opts.stPartyStopYear = "#oPartyStopYear.Value()#";");}

    if (oTemperature)
    {
      WriteLine("opts.stTemp = "#oTemperature.Value()#";");
      WriteLine("opts.stUnit = '"#sUnit#"';");
    }

    WriteLine("its"#chnId#" = new iseThermostat_2ndGen("#chnId#", "#rState#", "#iLvlDpId#", "#rMin#", "#rMax#", " #system.GetVar("iReadOnlyState")#", "#system.GetVar('bSliderFlag')#", opts);");
  WriteLine("</script>");

  return;
}

!POWERMETER
function ::CreatePowermeterControl() {
  object oDevice = dom.GetObject(cObj.Device());
  object oChannel = dom.GetObject(oDevice.Channels().GetAt(2));
  string chAddress = oChannel.Address();

  object oEnergyCounter = cObj.DPByControl("POWERMETER.ENERGY_COUNTER");
  object oPower = cObj.DPByControl("POWERMETER.POWER");
  object oCurrent = cObj.DPByControl("POWERMETER.CURRENT");
  object oVoltage = cObj.DPByControl("POWERMETER.VOLTAGE");
  object oFrequency = cObj.DPByControl("POWERMETER.FREQUENCY");
  object oBoot = cObj.DPByControl("POWERMETER.BOOT");
  object sysVarEnergyCounter = dom.GetObject("svEnergyCounter_"#chnId#"_"#chAddress);

  var energyCounter = "unknown";

  if (sysVarEnergyCounter) {
    energyCounter = sysVarEnergyCounter.Value().ToString(2)#" "#oEnergyCounter.ValueUnit();
  }

  ! html
  WriteLine("<tr>");
    WriteLine("<td>");
      WriteLine("<table>");

        ! EnergyCounter
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<span>${lblInfoStatusControlEnergyCounter}</span>");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<span id='"#chnId#"EnergyCounter'>"#energyCounter#"</span><br/><span id='"#chnId#"EnergyCostCCU' class='hidden'></span>");
                      WriteLine("</td>");
                    WriteLine("</tr>");

                   ! Displays the real value of the device
                   !WriteLine("<tr>");
                   !  WriteLine("<td>");
                   !    WriteLine("<span>${lblInfoStatusControlDevice}"#oEnergyCounter.Value().ToString(2)#" "#oEnergyCounter.ValueUnit()#"</span>");
                   !  WriteLine("</td>");
                   !WriteLine("</tr>");

                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");

         ! Reset EnergyCounter
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<div class='ControlBtnOff CLASS02550' style='line-height:35px' id='"#chnId#"resetEnergyCounter' >Reset</div>");
                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");

        ! Energy counter of the device
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
                WriteLine("<tr>");
                  WriteLine("<td>");
                    WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span>${lblInfoStatusControlDevice}</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                        WriteLine("<span>"#oEnergyCounter.Value().ToString(2)#" "#oEnergyCounter.ValueUnit()#"</span><br/><span id='"#chnId#"EnergyCostDevice' class='hidden'></span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                    WriteLine("</table>");
                  WriteLine("</td>");
                WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");

        ! Voltage & Current
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
                WriteLine("<tr>");
                  WriteLine("<td>");
                    WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span>${lblInfoStatusControlVoltage}</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span id='"#chnId#"Voltage'>"#oVoltage.Value().ToString(1)#" "#oVoltage.ValueUnit()#"</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                    WriteLine("</table>");
                  WriteLine("</td>");
                WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
                WriteLine("<tr>");
                  WriteLine("<td>");
                    WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span>${lblInfoStatusControlCurrent}</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span id='"#chnId#"Current'>"#oCurrent.Value().ToString(0)#" "#oCurrent.ValueUnit()#"</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                    WriteLine("</table>");
                  WriteLine("</td>");
                WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");

      ! Power & Frequency
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
                WriteLine("<tr>");
                  WriteLine("<td>");
                    WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span>${lblInfoStatusControlPower}</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span id='"#chnId#"Power'>"#oPower.Value().ToString(2)#" "#oPower.ValueUnit()#"</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                    WriteLine("</table>");
                  WriteLine("</td>");
                WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
                WriteLine("<tr>");
                  WriteLine("<td>");
                    WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span>${lblInfoStatusControlFrequency}</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span id='"#chnId#"Frequency'>"#oFrequency.Value().ToString(0)#" "#oFrequency.ValueUnit()#"</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                    WriteLine("</table>");
                  WriteLine("</td>");
                WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");

      WriteLine("</table>");
    WriteLine("</td>");
  WriteLine("<tr>");
  ! end html

  WriteLine("<script type='text/javascript'>");
    WriteLine("var opts = {};");
    WriteLine("opts.chType = 'POWERMETER';");
    WriteLine("opts.chAddress = '"#chAddress#"';");
    WriteLine("opts.bootFlag = "#oBoot.Value()#";");
    WriteLine("opts.idEnergyCounter = "#oEnergyCounter.ID()#";");
    WriteLine("opts.valEnergyCounter = "#oEnergyCounter.Value()#";");
    WriteLine("opts.unitEnergyCounter = '"#oEnergyCounter.ValueUnit()#"';");
    WriteLine("opts.maxValEnergyCounter = '"#oEnergyCounter.ValueMax()#"';");
    WriteLine("opts.minValEnergyCounter = '"#oEnergyCounter.ValueMin()#"';");
    WriteLine("opts.idPower = "#oPower.ID()#";");
    WriteLine("opts.valPower = "#oPower.Value()#";");
    WriteLine("opts.unitPower = '"#oPower.ValueUnit()#"';");
    WriteLine("opts.idCurrent = "#oCurrent.ID()#";");
    WriteLine("opts.valCurrent = "#oCurrent.Value()#";");
    WriteLine("opts.unitCurrent = '"#oCurrent.ValueUnit()#"';");
    WriteLine("opts.idVoltage = "#oVoltage.ID()#";");
    WriteLine("opts.valVoltage = "#oVoltage.Value()#";");
    WriteLine("opts.unitVoltage = '"#oVoltage.ValueUnit()#"';");
    WriteLine("opts.idFrequency = "#oFrequency.ID()#";");
    WriteLine("opts.valFrequency = "#oFrequency.Value()#";");
    WriteLine("opts.unitFrequency = '"#oFrequency.ValueUnit()#"';");

    WriteLine("ipm"#chnId#" = new isePowerMeter("#chnId#",opts);");

  WriteLine("</script>")

  return;
}

!POWERMETER_IGL
function ::CreatePowermeterIGLControl() {
  object oDevice = dom.GetObject(cObj.Device());
  object oChannel = dom.GetObject(oDevice.Channels().GetAt(1));
  string chAddress = oChannel.Address();
  string chType = oChannel.ChannelType();

  object oEnergyCounter = cObj.DPByControl("POWERMETER_IGL.ENERGY_COUNTER");
  object oEnergyCounterGas = cObj.DPByControl("POWERMETER_IGL.GAS_ENERGY_COUNTER");
  object oPower = cObj.DPByControl("POWERMETER_IGL.POWER");
  object oPowerGas = cObj.DPByControl("POWERMETER_IGL.GAS_POWER");
  object oBoot = cObj.DPByControl("POWERMETER_IGL.BOOT");
  object sysVarEnergyCounter = dom.GetObject("svEnergyCounter_"#chnId#"_"#chAddress);

  var energyCounter = "unknown";

  if (sysVarEnergyCounter) {
    energyCounter = sysVarEnergyCounter.Value().ToString(2);
  }

  ! html
  WriteLine("<tr>");
    WriteLine("<td>");
      WriteLine("<table>");

        ! EnergyCounter
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        WriteLine("<span>${lblInfoStatusControlEnergyCounter}</span>");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                    WriteLine("<tr>");
                      WriteLine("<td>");
                        !WriteLine("<span id='"#chnId#"EnergyCounter'>"#energyCounter#"</span><span name='"#chnId#"EnergyCostDeviceUnit' class='hidden'>"#oEnergyCounter.ValueUnit()#"</span><br/><span id='"#chnId#"EnergyCostCCU' class='hidden'></span>");
                        WriteLine("<span id='"#chnId#"EnergyCounter'>&nbsp;</span><br/><span id='"#chnId#"EnergyCostCCU' class='hidden'></span>");
                      WriteLine("</td>");
                    WriteLine("</tr>");
                  WriteLine("</table>");
                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");

         ! Reset EnergyCounter
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
              WriteLine("<tr>");
                WriteLine("<td>");
                  WriteLine("<div class='ControlBtnOff CLASS02550' style='line-height:35px' id='"#chnId#"resetEnergyCounter' >Reset</div>");
                WriteLine("</td>");
              WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");

        ! Energy counter of the device
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
                WriteLine("<tr>");
                  WriteLine("<td>");
                    WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span>${lblInfoStatusControlDevice}</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                        !WriteLine("<span>"#oEnergyCounter.Value().ToString(2)#"</span><span name='"#chnId#"EnergyCostDeviceUnit' class='hidden'>"#oEnergyCounter.ValueUnit()#"</span><br/><span id='"#chnId#"EnergyCostDevice' class='hidden'></span>");
                        WriteLine("<div name='"#chnId#"sensor' id='"#chnId#"CounterDevice' class ='hidden'><span>"#oEnergyCounter.Value().ToString(2)#"</span>&nbsp;<span name='"#chnId#"EnergyCostDeviceUnit' class='hidden'>"#oEnergyCounter.ValueUnit()#"</span><br/><span id='"#chnId#"EnergyCostDevice' class='hidden'></span></div>");
                        WriteLine("<div name='"#chnId#"sensorGas'id='"#chnId#"CounterDeviceGas' class='hidden'><span>"#oEnergyCounterGas.Value().ToString(2)#"</span>&nbsp;<span name='"#chnId#"EnergyCostDeviceUnit' class='hidden'>"#oEnergyCounterGas.ValueUnit()#"</span><br/><span id='"#chnId#"EnergyCostDeviceGas' class='hidden'></span></div>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                    WriteLine("</table>");
                  WriteLine("</td>");
                WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");

      ! Power
        WriteLine("<tr>");
          WriteLine("<td>");
            WriteLine("<table width='100%' _height='100%' cellspacing='4'>");
                WriteLine("<tr>");
                  WriteLine("<td>");
                    WriteLine("<table class='ControlBtnInfo' style='min-width: 205px;'>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          WriteLine("<span name='"#chnId#"sensor' class='hidden'>${lblInfoStatusControlPower}</span>");
                          WriteLine("<span name='"#chnId#"sensorGas' class='hidden'>${lblInfoStatusControlGas}</span>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                      WriteLine("<tr>");
                        WriteLine("<td>");
                          !WriteLine("<span id='"#chnId#"Power'>"#oPower.Value().ToString(2)#" "#oPower.ValueUnit()#"</span>");
                          WriteLine("<div name='"#chnId#"sensor' class='hidden'><span id='"#chnId#"Power'>"#oPower.Value().ToString(2)#" "#oPower.ValueUnit()#"</span></div>");
                          WriteLine("<div name='"#chnId#"sensorGas' class='hidden'><span id='"#chnId#"PowerGas'>"#oPowerGas.Value().ToString(2)#" m<sup>3</span></div>");
                        WriteLine("</td>");
                      WriteLine("</tr>");
                    WriteLine("</table>");
                  WriteLine("</td>");
                WriteLine("</tr>");
            WriteLine("</table>");
          WriteLine("</td>");
        WriteLine("</tr>");

      WriteLine("</table>");
    WriteLine("</td>");
  WriteLine("<tr>");
  ! end html

  WriteLine("<script type='text/javascript'>");
    WriteLine("var opts = {};");
    WriteLine("opts.chType =  'POWERMETER_IGL';");
    WriteLine("opts.chAddress = '"#chAddress#"';");
    WriteLine("opts.bootFlag = "#oBoot.Value()#";");
    WriteLine("opts.idEnergyCounter = "#oEnergyCounter.ID()#";");
    WriteLine("opts.valEnergyCounter = "#oEnergyCounter.Value()#";");
    WriteLine("opts.unitEnergyCounter = '"#oEnergyCounter.ValueUnit()#"';");
    WriteLine("opts.maxValEnergyCounter = '"#oEnergyCounter.ValueMax()#"';");
    WriteLine("opts.minValEnergyCounter = '"#oEnergyCounter.ValueMin()#"';");
    WriteLine("opts.idPower = "#oPower.ID()#";");
    WriteLine("opts.valPower = "#oPower.Value()#";");
    WriteLine("opts.unitPower = '"#oPower.ValueUnit()#"';");
    
    WriteLine("opts.idEnergyCounterGas = "#oEnergyCounterGas.ID()#";");
    WriteLine("opts.valEnergyCounterGas = "#oEnergyCounterGas.Value()#";");
    WriteLine("opts.unitEnergyCounterGas = '"#oEnergyCounterGas.ValueUnit()#"';");
    WriteLine("opts.maxValEnergyCounterGas = '"#oEnergyCounterGas.ValueMax()#"';");
    WriteLine("opts.minValEnergyCounterGas = '"#oEnergyCounterGas.ValueMin()#"';");
    WriteLine("opts.idPowerGas = "#oPowerGas.ID()#";");
    WriteLine("opts.valPowerGas = "#oPowerGas.Value()#";");
    WriteLine("opts.unitPowerGas = '"#oPowerGas.ValueUnit()#"';");


    WriteLine("ipm"#chnId#" = new isePowerMeter("#chnId#",opts);");

  WriteLine("</script>")

  return;
}

function ::CreateKeyMatic() {

  object oState = cObj.DPByControl("LOCK.STATE");
  object oUncertain = cObj.DPByControl("LOCK.UNCERTAIN"); 
  object oOpen = cObj.DPByControl("LOCK.OPEN"); 
  WriteLine("<td>");
    WriteLine("<table class='ControlBtnOff CLASS02511' id='"#oState.ID()#"Close'>"); 
    WriteLine("<tr>");
      WriteLine("<td  class='CLASS02513'>");
        WriteLine("<div align='center'>");
          WriteLine("<img src='/ise/img/lock/closed.png' width='80' height='80' />");
        WriteLine("</div>");            
      WriteLine("</td>");
    WriteLine("</tr>");
    WriteLine("<tr><td>${actionStatusControlClose}</td></tr>");
    WriteLine("</table>"); 
  WriteLine("</td>");
  WriteLine("<td>");
    WriteLine("<table class='ControlBtnOff CLASS02511' id='"#oState.ID()#"Open' >"); 
    WriteLine("<tr>");
      WriteLine("<td class='CLASS02513'>");
        WriteLine("<div align='center'>");
          WriteLine("<img src='/ise/img/lock/open.png' width='80' height='80' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    WriteLine("<tr><td>${actionStatusControlOpen}</td></tr>");
    WriteLine("</table>"); 
  WriteLine("</td>");
  WriteLine("<td>");
    WriteLine("<table class='ControlBtnOff CLASS02511' id='"#oOpen.ID()#"OpenDoor'>"); 
    WriteLine("<tr>");
      WriteLine("<td  class='CLASS02513'>");
        WriteLine("<div align='center'>");
          WriteLine("<img src='/ise/img/door/open.png' width='80' height='80' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    WriteLine("<tr><td>${actionStatusControlOpenDoor}</td></tr>");
    WriteLine("</table>"); 
  WriteLine("</td>");
  WriteLine("<td>");
    WriteLine("<table class='ControlBtnOff CLASS02511' id='"#oUncertain.ID()#"na' >"); 
    WriteLine("<tr><td>${infoStatusControlStateUnknown}</td></tr>");
    WriteLine("</table>"); 
  WriteLine("</td>");
  WriteLine("<td></td>");
  WriteLine('<script type="text/javascript">');
    WriteLine("var opts = {");
    WriteLine(" idState: "#oState.ID()#",");
    WriteLine(" idOpen: "#oOpen.ID()#",");
    WriteLine(" idUncertain: "#oUncertain.ID()#",");
    WriteLine(" stState: "#oState.Value()#",");
    WriteLine(" stOpen: '"#oOpen.Value()#"',");
    WriteLine(" stUncertain: "#oUncertain.Value());
    WriteLine("};");
    WriteLine("ibkm"#cObj.ID()#" = new iseButtonsKeyMatic("#cObj.ID()#", opts, " #system.GetVar("iStatusOnly")# ");");
    WriteLine("translatePage('#ctrl"#chnId#"tbl');");
  WriteLine('</script>');
  return;
}

function ::CreateDisplay()
{
  integer chnId = cObj.ID();
  object oDoor      = cObj.DPByControl("RC19_DISPLAY.DOOR");
  object oBulb      = cObj.DPByControl("RC19_DISPLAY.BULB");
  object oSwitch    = cObj.DPByControl("RC19_DISPLAY.SWITCH");
  object oWindow    = cObj.DPByControl("RC19_DISPLAY.WINDOW");
  object oBlind     = cObj.DPByControl("RC19_DISPLAY.BLIND");
  object oScene     = cObj.DPByControl("RC19_DISPLAY.SCENE");
  object oPhone     = cObj.DPByControl("RC19_DISPLAY.PHONE");
  object oBell      = cObj.DPByControl("RC19_DISPLAY.BELL");
  object oArrUp     = cObj.DPByControl("RC19_DISPLAY.ARROW_UP");
  object oArrDown   = cObj.DPByControl("RC19_DISPLAY.ARROW_DOWN");
  object oClock     = cObj.DPByControl("RC19_DISPLAY.CLOCK");
  object oText      = cObj.DPByControl("RC19_DISPLAY.TEXT");
  object oUnit      = cObj.DPByControl("RC19_DISPLAY.UNIT");
  object oBacklight = cObj.DPByControl("RC19_DISPLAY.BACKLIGHT");
  object oBeep      = cObj.DPByControl("RC19_DISPLAY.BEEP");
  object oSubmit    = cObj.DPByControl("RC19_DISPLAY.SUBMIT");
  string sReadOnly;
  string s1;
  foreach( s1, cObj.DPs().EnumIDs() )
  {
    object o1 = dom.GetObject( s1 );
    if( o1 )
    {
      WriteLine( '<script>conInfo("GOT OBJECT ['#o1.Name()#']");</script>' );
    }
  }
  if( system.GetVar("iStatusOnly") == 1 )
  {
    sReadOnly = "disabled";
  }
  if( oDoor && oBulb && oSwitch && oWindow && oBlind && oScene && oPhone && oBell && oArrUp && oArrDown && oClock && oText && oUnit && oBeep && oSubmit )
  {
    WriteLine("<td colspan='5' class='CLASS02553'>");
      WriteLine("<table class='ControlBtnOff'>");
      WriteLine("<tr class='CLASS02546'>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/lamp.png' /></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cBulb"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/switch.png' /></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cSwitch"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/open.png' /></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cWnd"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/door.png' /></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cDoor"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/shutter.png' "#sReadOnly#"/></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cBlind"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/scene.png' "#sReadOnly#"/></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cScene"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/phone.png' "#sReadOnly#"/></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cPhone"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/bell.png' "#sReadOnly#"/></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cBell"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td></td>");
      WriteLine("</tr>");
      WriteLine("<tr>");
        WriteLine("<td colspan='2'><input class='CLASS02547'  type='text' id='txt"#chnId#"' "#sReadOnly#"/></td>");
        WriteLine("<td colspan='2'>");
          WriteLine("<select class='CLASS02547' id='selUnit"#chnId#"'"#sReadOnly#">");
          integer iVLCount = web.webGetValueListCount( oUnit.ValueList() );
          iVLCount = iVLCount - 1;
          string sVLKey;
          foreach( sVLKey, system.GenerateEnum(0,iVLCount) )
          {
            string sVLValue = web.webGetValueFromList( oUnit.ValueList(), sVLKey );
            if( sVLValue.Length() )
            {
              string sLongKey = cObj.ChnLabel()#"|"#oUnit.HSSID()#"="#sVLValue;
              string sShortKey = oUnit.HSSID()#"="#sVLValue;
              string sValue = web.webKeyFromStringTable(sLongKey);
              if( !sValue.Length() )
              {
                string sValue = web.webKeyFromStringTable(sShortKey);
                if( !sValue.Length() )
                {
                  sValue = sShortKey;
                }
              }
              WriteLine( "<option>"#sValue#"</option>" );
            }
          }
          WriteLine("</select>");
        WriteLine("</td>");
        WriteLine("<td colspan='2'>");        
        WriteLine("<select class='CLASS02547' id='selLight"#chnId#"'"#sReadOnly#">");
        if( oBacklight )
        {
          integer iVLCount = web.webGetValueListCount( oBacklight.ValueList() );
          iVLCount = iVLCount - 1;
          string sVLKey;
          foreach( sVLKey, system.GenerateEnum(0,iVLCount) )
          {
            string sVLValue = web.webGetValueFromList( oBacklight.ValueList(), sVLKey );
            if( sVLValue.Length() )
            {
              string sLongKey = cObj.ChnLabel()#"|"#oBacklight.HSSID()#"="#sVLValue;
              string sShortKey = oBacklight.HSSID()#"="#sVLValue;
              string sValue = web.webKeyFromStringTable(sLongKey);
              if( !sValue.Length() )
              {
                string sValue = web.webKeyFromStringTable(sShortKey);
                if( !sValue.Length() )
                {
                  sValue = sShortKey;
                }
              }
              WriteLine( "<option>"#sValue#"</option>" );
            }
          }
        }
        WriteLine("</select>");
        WriteLine("</td>");
        WriteLine("<td colspan='2'>");
        WriteLine("<select class='CLASS02547' id='selBeep"#chnId#"'"#sReadOnly#">");
          integer iVLCount = web.webGetValueListCount( oBeep.ValueList() );
          iVLCount = iVLCount - 1;
          string sVLKey;
          foreach( sVLKey, system.GenerateEnum(0,iVLCount) )
          {
            string sVLValue = web.webGetValueFromList( oBeep.ValueList(), sVLKey );
            if( sVLValue.Length() )
            {
              string sLongKey = cObj.ChnLabel()#"|"#oBeep.HSSID()#"="#sVLValue;
              string sShortKey = oBeep.HSSID()#"="#sVLValue;
              string sValue = web.webKeyFromStringTable(sLongKey);
              if( !sValue.Length() )
              {
                string sValue = web.webKeyFromStringTable(sShortKey);
                if( !sValue.Length() )
                {
                  sValue = sShortKey;
                }
              }
              WriteLine( "<option>"#sValue#"</option>" );
            }
          }
          WriteLine("</select>");
        WriteLine("</td>");
      WriteLine("</tr>");
      WriteLine("<tr>");
        WriteLine("<td colspan='4'></td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/clock.png' /></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cClock"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/arrow_up.png' /></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cArrUp"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td>");
          WriteLine("<table class='CLASS02518'>");
            WriteLine("<tr>");
              WriteLine("<td rowspan='3'><img src='/ise/img/rc19/arrow_down.png' "#sReadOnly#"/></td>");
              WriteLine("<td></td>");
            WriteLine("</tr>");
            WriteLine("<tr>");
              WriteLine("<td><input type='checkbox' id='cArrDown"#chnId#"' "#sReadOnly#"/></td>");
            WriteLine("</tr>");
          WriteLine("</table>");
        WriteLine("</td>");
        WriteLine("<td><img src='/ise/img/rc19/disp_enter.png' onclick='iseChannels.saveDisplayValues("#chnId#")' height='25px' width='70px' ></td>");
      WriteLine("</tr>");
      WriteLine("</table>");
    WriteLine("</td>");
  }
  return;
}

function ::CreateUnknown()
{
  boolean bStatusOnly = (system.GetVar("iStatusOnly") == 0);
  WriteLine( '<td class="CLASS02519">' );
    WriteLine( '<table cellspacing="10">' );
    WriteLine( '<tr>');
    integer i = 0;
    string sEnum = "";
    
    if( (cObj.IsTypeOf( OT_VARDP )) || (cObj.IsTypeOf( OT_ALARMDP)) )
    {
      sEnum = cObj.ID().ToString();
    }
    else
    {
      sEnum = cObj.DPs().EnumEnabledVisibleIDs();
    }
    
    string sKnownControls = "NONE.SWITCH.DIMMER.BLIND.WINDOW.LOCK.BUTTON.RC19_DISPLAY.DOOR_SENSOR.RHS.TEMP.ANALOG_OUTPUT.";
    string s;
    foreach( s, sEnum )
    {
      object oDP = dom.GetObject( s );
      if( oDP )
      {
        boolean bIsKnownControl = false;
        string sCName = oDP.MetaData("CONTROL");
        if( sCName )
        {
          integer iPosPoint = sCName.Find('.');
          if( iPosPoint != -1 )
          {
            string sCtrlName = sCName.Substr(0,iPosPoint);
            integer iPosCtrl = sKnownControls.Find( sCtrlName );
            if( iPosCtrl != -1 )
            {
              bIsKnownControl = true;
            }
          }
          !# Parameter is not visible
          if(  sCName.Find("INVISIBLE") > -1)
          {
            WriteLine( "<script>conInfo('Control not visible.');</script>" );
            isInvisible = true;
          } else {
            isInvisible = false;
          }
        }
        if( (!bIsKnownControl) && (!isInvisible) )
        {
          var value = oDP.Value();

          boolean bIsSysVar = ((oDP.IsTypeOf( OT_VARDP )) || (oDP.IsTypeOf( OT_ALARMDP )));
          boolean bIsHssDp = ( oDP.IsTypeOf( OT_HSSDP ) );
          boolean bChannel = ( cObj.IsTypeOf( OT_CHANNEL ) );
          string sTitle = "";
          string sKey = "";
          boolean bHideValue = false;
          if( bChannel )
          {
            if( bIsHssDp )
            {
              string sLongKey = cObj.HssType()#"|"#oDP.HSSID();
              string sShortKey = oDP.HSSID();
              if( (oDP.ValueType() == ivtInteger) && (oDP.ValueSubType() == istEnum) )
              {
                sLongKey = sLongKey#"="#web.webGetValueFromList( oDP.ValueList(), value );
                sShortKey = sShortKey#"="#web.webGetValueFromList( oDP.ValueList(), value );
                bHideValue = true;
              }
              if( (oDP.ValueType() == ivtBinary ) && ((oDP.ValueSubType() == istGeneric)||(oDP.ValueSubType() == istBool)||(oDP.ValueSubType() == istSwitch)) )
              {
                string sPVal = "";
                if( oDP.Value() )
                {
                  sPVal = "TRUE";
                }
                else
                {
                  sPVal = "FALSE";
                }
                sLongKey = sLongKey#"="#sPVal;
                sShortKey = sShortKey#"="#sPVal;
                bHideValue = true;
              }
              sTitle = web.webKeyFromStringTable( sLongKey );
              if( !sTitle.Length() )
              {
                sTitle = web.webKeyFromStringTable( sShortKey );
                if( !sTitle.Length() )
                {
                  sTitle = "["#sShortKey#"]";
                }
              }
            }
            else
            {
              sTitle = oDP.Name();
            }
          }
          else
          {
            sTitle = oDP.Name();
          }

          string sValueUnit = oDP.ValueUnit();
          string sSpace = " ";
          if( sValueUnit == "degree" ) { sValueUnit = "&deg;"; sSpace = ""; }
          if( sValueUnit == "100%" )
          {
            value = value * 100;
            sValueUnit = "%";
          }
          if( sValueUnit == "%" )
          {
            sSpace = "";
          }

          string sValue = "?";

          boolean bBoolean = ( value.Type() == "boolean" );
          boolean bReal = ( value.Type() == "real" );

          if( bBoolean && bChannel )
          {
            string sVLKey = "";
            if( value == false ) { sVLKey = "=FALSE"; }
            if( value == true ) { sVLKey = "=TRUE"; }
            sValue = web.webKeyFromStringTable( sKey#sVLKey );
            if( !sValue.Length() )
            {
              sValue = value.ToString(0);
              if( !sTitle.Length() )
              {
                sTitle = sKey;
              }
            }
            else
            {
              sTitle = "";
            }
          }
          else
          {
            if( !sTitle.Length() )
            {
              sTitle = sKey;
            }
          }

          if( bReal )
          {
            sValue = value.ToString(2);
          }

          if( (!bBoolean) && (!bReal) )
          {
            sValue = value.ToString(0);
          }

          if( !value.ToString().Length() )
          {
            sValue = "0";
          }

          if( bHideValue )
          {
            if( ( oDP.Operations() & OPERATION_WRITE ) == 0 )
            {
              sValue = sTitle;
              sTitle = "";
            }
          }

         ! if( !(i%2) ) { WriteLine( '<tr>' ); }
          boolean bExistControl = true;
          if( (bStatusOnly) && (!bIsSysVar) && (sLastControlName != ""))
          {
            bExistControl = false;
          }
          if( bExistControl  )
          {
            WriteLine( '<td>' );

              WriteLine( '<div class="ControlBtnInfo CLASS02532" >' );
                WriteLine( '<span class="CLASS02533"><span class="CLASS02534 j_translate">'#sTitle#'</span>' );
                boolean tbRead =  ( ( oDP.Operations() & OPERATION_READ ) != 0 );
                boolean tbEvent = ( ( oDP.Operations() & OPERATION_EVENT ) != 0 );
                boolean tbWrite = ( ( oDP.Operations() & OPERATION_WRITE ) != 0 );
                boolean bBoolean = false;

                if (cObj.IsTypeOf(OT_VARDP) || cObj.IsTypeOf(OT_ALARMDP)) {
                  tbWrite = false;
                }

                WriteLine( '<span class="CLASS02535">' );

                if( !tbWrite )
                {
                  string sValueh = "";
                  if (oDP.HssType() == "WIND_DIRECTION")
                  {
                    Call("/esp/datapointconfigurator.fn::ConvWindDir()");
                  }
                  WriteLine(sValueh#sSpace#sValue#sSpace#sValueUnit );
                }
                else
                {
                  if( !bBoolean )
                  {
                    if( (bStatusOnly) && (!bIsSysVar) && (sLastControlName == ""))
                    {
                      string sDivider = "";
                      if( oDP.ValueUnit() == "100%" ) { sDivider = "/100"; }
                      WriteLine( "<input size='6' value='"#sValue#"' onblur='setDpState("#oDP.ID()#", value"#sDivider#")' />"#sSpace#sValueUnit );
                    }
                    else
                    {
                      string sSysVarVal = "";
                      object cObjTmp = oDP;
                      integer iVT = oDP.ValueType();
                      integer iST = oDP.ValueSubType();
                      boolean bLogic  = ( (iVT==ivtBinary)  && (iST==istBool)    );
                      boolean bList   = ( (iVT==ivtInteger) && (iST==istEnum)    );
                      boolean bNumber = ( (iVT==ivtFloat)   && (iST==istGeneric) );
                      boolean bAlarm  = ( (iVT==ivtBinary)  && (iST==istAlarm)   );
                      boolean bString = ( (iVT==ivtString)  && (iST==istChar8859));
                      Call( "/esp/system.fn::getSysVarValAsString()" );
                      WriteLine( sSysVarVal );
                    }
                  }
                  else
                  {

                    if( system.GetVar("iStatusOnly") == 0 )
                    {
                      string sClassName;

                      sClassName = "CLASS02516";
                      if( oDP.Value() == true ) { sClassName = "CLASS02517"; }
                      WriteLine("<span class='" # sClassName # "' onclick='setDpState("#oDP.ID()#", true)'>&nbsp;&nbsp;An&nbsp;&nbsp;</span>&nbsp;&nbsp;");

                      sClassName = "CLASS02516";
                      if( (oDP.Value() == false) || (oDP.Value() == "") ) { sClassName = "CLASS02517"; }
                      WriteLine("<span class='" # sClassName # "' onclick='setDpState("#oDP.ID()#", false)'>&nbsp;Aus&nbsp;</span>");
                    }
                    else
                    {
                      if (oDP.Value())
                      {
                        WriteLine(oDP.ValueName1());
                      }
                      else
                      {
                        WriteLine(oDP.ValueName0());
                      }
                    }
                  }
                }
                WriteLine("</span></span>");
              WriteLine( '</div>' );
            WriteLine( '</td>' );
          }
          if( (i%2) ) { WriteLine( '</tr><tr>' ); }
          i = i + 1;
        }
      }
    }
  WriteLine('</tr>');
  WriteLine('</table>');
  WriteLine('</td>');
  WriteLine('<script type="text/javascript">translatePage("#tblHDeviChannel");</script>');
  return;
}

function ::CreateKey() {
  integer iShortId = 0;
  integer iLongId = 0;
  object objShort = cObj.DPByControl("BUTTON.SHORT");
  integer objID = cObj.ID();
  if (objShort) {
    iShortId = objShort.ID();
  }
  object objLong = cObj.DPByControl("BUTTON.LONG");
  if (objLong) {
    iLongId = objLong.ID();
  }
  WriteLine("<td class='CLASS02515'>");
    WriteLine("<table class='ControlBtnOff CLASS02511' id='"#chnId#"Short' >"); 
    WriteLine("<tr>");
      WriteLine("<td class='CLASS02518'>");
        WriteLine("<div align='center'>");
          WriteLine("<img id='btn"#iShortId#"s' src='/ise/img/btn_no_press.png' width='80' height='80' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    !WriteLine("<tr><td id='sKP"#chnId#"' class='CLASS02536 _j_translate'>Kurzer Tastendruck</td></tr>");
    WriteLine("<tr><td id='sKP"#chnId#"' class='CLASS02536'>&nbsp; </td></tr>");
    Write("<script type='text/javascript'>");
      Write("jQuery('#sKP"#chnId#"').html(translateKey('actionStatusControlLblShortKeyPress'));");
    Write("</script>");

    WriteLine("</table>");
  WriteLine("</td>");
  WriteLine("<td class='CLASS02515'>");
    WriteLine("<table class='ControlBtnOff CLASS02511' id='"#chnId#"Long' >"); 
    WriteLine("<tr>");
      WriteLine("<td  class='CLASS02518'>");
        WriteLine("<div align='center'>");
          WriteLine("<img id='btn"#iLongId#"l' src='/ise/img/btn_no_press.png' width='80px' height='80px' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    !WriteLine("<tr><td id='lKP"#chnId#"' class='_j_translate'>AG Langer Tastendruck</td></tr>");
    WriteLine("<tr><td id='lKP"#chnId#"'>&nbsp;</td></tr>");
    Write("<script type='text/javascript'>");
      Write("jQuery('#lKP"#chnId#"').html(translateKey('actionStatusControlLblLongKeyPress'));");
    Write("</script>");

    WriteLine("</table>");
  WriteLine("</td>");
  WriteLine("<td></td><td></td><td></td>");

  Write("<script type='text/javascript'>");
    !WriteLine("ibk"#cObj.ID()#" = new iseButtonsKey("#cObj.ID()#", "#iShortId#", "#iLongId#", "#system.GetVar("iStatusOnly")#");");
    WriteLine("ibk"#objID#" = new iseButtonsKey("#cObj.ID()#", "#iShortId#", "#iLongId#", "#system.GetVar("iStatusOnly")#");");
  Write("</script>");
  return;
}

function ::CreateKeyShortOnly() {
  integer iShortId = 0;
  integer iLongId = 0;
  object objShort = cObj.DPByControl("BTN_SHORT_ONLY.SHORT"); 
  if (objShort) {
    iShortId = objShort.ID();
  }
  object objLong = cObj.DPByControl("BTN_SHORT_ONLY.X");
  if (objLong) {
    iLongId = objLong.ID();
  }
  WriteLine("<td class='CLASS02515'>");
    WriteLine("<table class='ControlBtnOff CLASS02511' id='"#chnId#"Short' >"); 
    WriteLine("<tr>");
      WriteLine("<td class='CLASS02518'>");
        WriteLine("<div align='center'>");
          WriteLine("<img id='btn"#iShortId#"s' src='/ise/img/btn_no_press.png' width='80' height='80' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    WriteLine("<tr><td id='btnTxt"#iShortId#"s' class='CLASS02536'>&nbsp;</td></tr>");

    Write("<script type='text/javascript'>");
      Write("jQuery('#btnTxt"#iShortId#"s').html(translateKey('actionStatusControlLblShortKeyPress'));");
    Write("</script>");

    WriteLine("</table>"); 
  WriteLine("</td>");
!	WriteLine("<td class='CLASS02515 hidden'>");
! 	  WriteLine("<table class='ControlBtnOff CLASS02511' id='"#chnId#"Long' >");
!    WriteLine("<tr>");
! 	    WriteLine("<td  class='CLASS02518'>");
!   	    WriteLine("<div align='center'>");
!     	    WriteLine("<img id='btn"#iLongId#"l' src='/ise/img/btn_no_press.png' width='80px' height='80px' />");
!        WriteLine("</div>");
! 	    WriteLine("</td>");
!    WriteLine("</tr>");
!    WriteLine("<tr><td>Langer Tastendruck</td></tr>");
! 	  WriteLine("</table>");
!  WriteLine("</td>");
  WriteLine("<td></td><td></td><td></td><td></td>");
  WriteLine("<script type='text/javascript'>");
  WriteLine("ibk"#cObj.ID()#" = new iseButtonsKey("#cObj.ID()#", "#iShortId#", "#iLongId#", "#system.GetVar("iStatusOnly")#");");
  WriteLine("</script>");
  return;
}


! cObj, chnId 
function ::CreateDoorOpener() {
  var iId = 0;
  var oDoorOpener = cObj.DPByControl("DOOROPENER.STATE"); 

  if (oDoorOpener) { iId = oDoorOpener.ID(); }

  WriteLine("<td class='CLASS02515'>");
    WriteLine("<table class='ControlBtnOff CLASS02511' id='" # chnId # "DoorOpener' >"); 
    WriteLine("<tr>");
      WriteLine("<td  class='CLASS02513'>");
        WriteLine("<div align='center'>");
          WriteLine("<img src='/ise/img/door/open.png' width='80' height='80' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    WriteLine("<tr><td>${actionStatusControlOpenDoor}</td></tr>");
    WriteLine("</table>");     
  WriteLine("</td>");
  WriteLine("<td></td><td></td><td></td>");
  
  WriteLine("<script type='text/javascript'>");
  WriteLine("ibk" # cObj.ID() # " = new DoorOpenerControl(" # cObj.ID() # ", " #iId# ",  " # system.GetVar("iStatusOnly") # ");");
  WriteLine("translatePage('#ctrl"#chnId#"tbl');");
  WriteLine("</script>");
  
  return;
}

function ::ConvWindDir() {

! --- Konvertierung der Gradanzeige in Himmelsrichtungen ---

 integer iValue = sValue.ToInteger() ; 
 
 sValueh = "no value";
 
 if ( (iValue >= 346) || (iValue <= 15) ) 
 { 
  sValueh = "N  ";
  return;
 }
 if ( (iValue >= 16) && (iValue <= 75) )
 {
  sValueh = "NO  ";  
  return;
 }
 if ( (iValue >= 76) && (iValue <= 105) )
 {
  sValueh = "O  ";  
  return;
 }
 if ( (iValue >= 106) && (iValue <= 165) )
 {
  sValueh = "SO  ";  
  return;
 }
 if ( (iValue >= 166) && (iValue <= 195) )
 {
  sValueh = "S  ";  
  return;
 }
 if ( (iValue >= 196) && (iValue <= 255) )
 {
  sValueh = "SW  ";  
  return;
 }
 if ( (iValue >= 256) && (iValue <= 285) )
 {
  sValueh = "W  ";  
  return;
 }
 if ( (iValue >= 286) && (iValue <= 345) )
 {
  sValueh = "NW  ";  
  return;
 }

 return;
}


function ::CreateWndRotSensor() {
  WriteLine("<td>");
    WriteLine("<table class='ControlBtnOff CLASS02514' id='"#chnId#"OpenH' >"); 
    WriteLine("<tr>");
      WriteLine("<td class='CLASS02513'>");
        WriteLine("<div align='center'>");
          WriteLine("<img src='/ise/img/window/open_h.png' width='80' height='80' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    WriteLine("<tr><td>${actionStatusControlOpenA}</td></tr>");
    WriteLine("</table>"); 
  WriteLine("</td>");
  WriteLine("<td>");
    WriteLine("<table class='ControlBtnOff CLASS02514' id='"#chnId#"OpenV' >"); 
    WriteLine("<tr>");
      WriteLine("<td class='CLASS02513'>");
        WriteLine("<div align='center'>");
          WriteLine("<img src='/ise/img/window/open_v.png' width='80' height='80' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    WriteLine("<tr><td>${actionStatusControlTilted}</td></tr>");
    WriteLine("</table>"); 
  WriteLine("</td>");
  WriteLine("<td>");
    WriteLine("<table class='ControlBtnOff CLASS02514' id='"#chnId#"Closed' >"); 
    WriteLine("<tr>");
      WriteLine("<td class='CLASS02513'>");
        WriteLine("<div align='center'>");
          WriteLine("<img src='/ise/img/window/closed.png' width='80' height='80' />");
        WriteLine("</div>");
      WriteLine("</td>");
    WriteLine("</tr>");
    WriteLine("<tr><td>${actionStatusControlLockedA}</td></tr>");
    WriteLine("</table>"); 
  WriteLine("</td>");
  
  object objState = cObj.DPByControl("RHS.STATE"); 
  WriteLine("<td></td><td></td>");
  WriteLine("<script type='text/javascript'>");
  WriteLine("ibw"#cObj.ID()#" = new iseButtonsWindow("#chnId#", "#objState.Value()#");");
  WriteLine("</script>");
  return; 
}

function ::CreateSysVar()
{
  string sName = "";
  WriteLine( '<td class="CLASS02537">' );
    WriteLine( '<div class="ControlBtnInfo CLASS02538" >' );
      sName = cObj.Name();
      WriteLine( '<span class="CLASS02534">'#sName#':  </span>' );
      
      string sSysVarVal = '';
      object cObjTmp = cObj;
      Call( "/esp/system.fn::getSysVarValAsString()" );
  
      WriteLine( '<span id="sysvs'#cObj.ID()#'" class="CLASS02535">'#sSysVarVal#'</span>' );
    WriteLine( '</div>' );
  WriteLine( '</td>' );
  return;
}

function ::CreateSysVars()
{
  WriteLine( '<td class="CLASS02539">' );
  WriteLine( '<table cellspacing="10">' );
  WriteLine( '<tr>');
  integer i = 0;
  string s;
  foreach(s,cObj.DPs().EnumIDs())
  {
    object oSV = dom.GetObject( s );
    if( oSV )
    {
      if( oSV.IsTypeOf( OT_VARDP ) || oSV.IsTypeOf( OT_ALARMDP ) )
      {
!        if( !(i%2) ) { WriteLine( '<tr>' ); }
        WriteLine( '<td class="CLASS02540">' );
          WriteLine( '<div class="ControlBtnInfo CLASS02538" >' );
            WriteLine( '<span class="CLASS02534">'#oSV.Name()#':  </span>' );
            
            string sSysVarVal = "";
            object cObjTmp = oSV;
            integer iVT = cObjTmp.ValueType();
            integer iST = cObjTmp.ValueSubType();
            boolean bLogic  = ( (iVT==ivtBinary)  && (iST==istBool)    );
            boolean bList   = ( (iVT==ivtInteger) && (iST==istEnum)    );
            boolean bNumber = ( (iVT==ivtFloat)   && (iST==istGeneric) );
            boolean bAlarm  = ( (iVT==ivtBinary)  && (iST==istAlarm)   );
            boolean bString = ( (iVT==ivtString)  && (iST==istChar8859));
            boolean bSysVar = ( bLogic || bList || bNumber || bAlarm || bString);
            Call( "/esp/system.fn::getSysVarValAsString()" );
        
            WriteLine( '<span class="CLASS02535">'#sSysVarVal#'</span>' );
          WriteLine( '</div>' );
        WriteLine( '</td>' );
        if( (i%2) ) { WriteLine( '</tr><tr>' ); }
        i = i + 1;
      }
    }
  }
  WriteLine( '</tr>' );
  WriteLine( '</table>' );
  WriteLine( '</td>' );
  
  return;
}
